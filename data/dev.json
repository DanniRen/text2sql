[
  {
    "query": "select  a.itype,\n        a.dtstatdate,\n        datediff(b.dtstatdate,a.dtstatdate) as idaynum,\n        count(distinct a.vplayerid)           as iusernum\nfrom (                      \n    select\n        itype,\n        min(dtstatdate) as dtstatdate,\n        vplayerid\n    from  (\n        select '广域战场'      as itype,\n                min(dtstatdate) as dtstatdate,\n                vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240723' and dtstatdate <= date_add('20240723',6)\n        and submodename = '广域战场模式'\n        group by vplayerid\n\n        union all\n        select '消灭战', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20230804' and dtstatdate <= date_add('20230804',6)\n        and modename='组队竞技' and submodename like '%消灭战模式%'\n        group by vplayerid\n\n        union all\n        select '幻想混战', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241115' and dtstatdate <= date_add('20241115',6)\n        and modename='创意创作间' and submodename='幻想混战'\n        group by vplayerid\n\n        union all\n        select '荒野传说', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240903' and dtstatdate <= date_add('20240903',6)\n        and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n        group by vplayerid\n\n        union all\n        select '策略载具', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241010' and dtstatdate <= date_add('20241010',6)\n        and modename='休闲模式' and submodename like '%策略载具%'\n        group by vplayerid\n\n        union all\n        select '炎夏混战', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240625' and dtstatdate <= date_add('20240625',6)\n        and modename='创意创作间' and submodename like '%炎夏混战%'\n        group by vplayerid\n\n        union all\n        select '单人装备', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240517' and dtstatdate <= date_add('20240517',6)\n        and modename='组队竞技' and submodename like '%单人装备%'\n        group by vplayerid\n\n        union all\n        select '交叉堡垒', min(dtstatdate), vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240412' and dtstatdate <= date_add('20240412',6)\n        and modename='组队竞技' and submodename like '%交叉堡垒%'\n        group by vplayerid\n    ) t\n    group by itype, vplayerid\n) a\nleft join (\n        select '广域战场' as itype, dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240723' and dtstatdate <= date_add('20240723',13)\n          and submodename = '广域战场模式'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '消灭战', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20230804' and dtstatdate <= date_add('20230804',13)\n          and modename='组队竞技' and submodename like '%消灭战模式%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '幻想混战', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241115' and dtstatdate <= date_add('20241115',13)\n          and modename='创意创作间' and submodename='幻想混战'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '荒野传说', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240903' and dtstatdate <= date_add('20240903',13)\n          and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n        group by dtstatdate, vplayerid\n\n        union all\n        select '策略载具', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20241010' and dtstatdate <= date_add('20241010',13)\n          and modename='休闲模式' and submodename like '%策略载具%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '炎夏混战', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240625' and dtstatdate <= date_add('20240625',13)\n          and modename='创意创作间' and submodename like '%炎夏混战%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '单人装备', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240517' and dtstatdate <= date_add('20240517',13)\n          and modename='组队竞技' and submodename like '%单人装备%'\n        group by dtstatdate, vplayerid\n\n        union all\n        select '交叉堡垒', dtstatdate, vplayerid\n        from dws_jordass_mode_roundrecord_di\n        where dtstatdate >= '20240412' and dtstatdate <= date_add('20240412',13)\n          and modename='组队竞技' and submodename like '%交叉堡垒%'\n        group by dtstatdate, vplayerid\n) b\n  on  a.itype      = b.itype\nand  a.vplayerid    = b.vplayerid\nwhere datediff(b.dtstatdate,a.dtstatdate) between 0 and 7\ngroup by a.itype, a.dtstatdate, datediff(b.dtstatdate,a.dtstatdate);\n",
    "question": "统计各个玩法上线首周留存情况\n输出：玩法、上线首周首次玩的日期、第几天留存（0,1,2...7)、玩法留存用户数\n\n各玩法首周上线日期：\n\"广域战场\": \"20240723\",\n\"消灭战\": \"20230804\",\n\"幻想混战\": \"20241115\",\n\"荒野传说\": \"20240903\",\n\"策略载具\": \"20241010\",\n\"炎夏混战\": \"20240625\",\n\"单人装备\": \"20240517\",\n\"交叉堡垒\": \"20240412\"",
    "query_toks": [
      "select",
      "a",
      ".itype",
      ",",
      "a",
      ".dtstatdate",
      ",",
      "datediff",
      "(",
      "b",
      ".dtstatdate",
      ",",
      "a",
      ".dtstatdate",
      ")",
      "as",
      "idaynum",
      ",",
      "count",
      "(",
      "distinct",
      "a",
      ".vplayerid",
      ")",
      "as",
      "iusernum",
      "from",
      "(",
      "select",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "as",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "(",
      "select",
      "'广域战场'",
      "as",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "as",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240723'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240723'",
      ",",
      "6",
      ")",
      "and",
      "submodename",
      "=",
      "'广域战场模式'",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "'消灭战'",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20230804'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20230804'",
      ",",
      "6",
      ")",
      "and",
      "modename",
      "=",
      "'组队竞技'",
      "and",
      "submodename",
      "like",
      "'%消灭战模式%'",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "'幻想混战'",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20241115'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20241115'",
      ",",
      "6",
      ")",
      "and",
      "modename",
      "=",
      "'创意创作间'",
      "and",
      "submodename",
      "=",
      "'幻想混战'",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "'荒野传说'",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240903'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240903'",
      ",",
      "6",
      ")",
      "and",
      "modename",
      "=",
      "'休闲模式'",
      "and",
      "submodename",
      "in",
      "(",
      "'荒野传说'",
      ",",
      "'荒野沙漠'",
      ")",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "'策略载具'",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20241010'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20241010'",
      ",",
      "6",
      ")",
      "and",
      "modename",
      "=",
      "'休闲模式'",
      "and",
      "submodename",
      "like",
      "'%策略载具%'",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "'炎夏混战'",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240625'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240625'",
      ",",
      "6",
      ")",
      "and",
      "modename",
      "=",
      "'创意创作间'",
      "and",
      "submodename",
      "like",
      "'%炎夏混战%'",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "'单人装备'",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240517'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240517'",
      ",",
      "6",
      ")",
      "and",
      "modename",
      "=",
      "'组队竞技'",
      "and",
      "submodename",
      "like",
      "'%单人装备%'",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "'交叉堡垒'",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240412'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240412'",
      ",",
      "6",
      ")",
      "and",
      "modename",
      "=",
      "'组队竞技'",
      "and",
      "submodename",
      "like",
      "'%交叉堡垒%'",
      "group",
      "by",
      "vplayerid",
      ")",
      "t",
      "group",
      "by",
      "itype",
      ",",
      "vplayerid",
      ")",
      "a",
      "left",
      "join",
      "(",
      "select",
      "'广域战场'",
      "as",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240723'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240723'",
      ",",
      "13",
      ")",
      "and",
      "submodename",
      "=",
      "'广域战场模式'",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'消灭战'",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20230804'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20230804'",
      ",",
      "13",
      ")",
      "and",
      "modename",
      "=",
      "'组队竞技'",
      "and",
      "submodename",
      "like",
      "'%消灭战模式%'",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'幻想混战'",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20241115'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20241115'",
      ",",
      "13",
      ")",
      "and",
      "modename",
      "=",
      "'创意创作间'",
      "and",
      "submodename",
      "=",
      "'幻想混战'",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'荒野传说'",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240903'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240903'",
      ",",
      "13",
      ")",
      "and",
      "modename",
      "=",
      "'休闲模式'",
      "and",
      "submodename",
      "in",
      "(",
      "'荒野传说'",
      ",",
      "'荒野沙漠'",
      ")",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'策略载具'",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20241010'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20241010'",
      ",",
      "13",
      ")",
      "and",
      "modename",
      "=",
      "'休闲模式'",
      "and",
      "submodename",
      "like",
      "'%策略载具%'",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'炎夏混战'",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240625'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240625'",
      ",",
      "13",
      ")",
      "and",
      "modename",
      "=",
      "'创意创作间'",
      "and",
      "submodename",
      "like",
      "'%炎夏混战%'",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'单人装备'",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240517'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240517'",
      ",",
      "13",
      ")",
      "and",
      "modename",
      "=",
      "'组队竞技'",
      "and",
      "submodename",
      "like",
      "'%单人装备%'",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'交叉堡垒'",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240412'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240412'",
      ",",
      "13",
      ")",
      "and",
      "modename",
      "=",
      "'组队竞技'",
      "and",
      "submodename",
      "like",
      "'%交叉堡垒%'",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      ")",
      "b",
      "on",
      "a",
      ".itype",
      "=",
      "b",
      ".itype",
      "and",
      "a",
      ".vplayerid",
      "=",
      "b",
      ".vplayerid",
      "where",
      "datediff",
      "(",
      "b",
      ".dtstatdate",
      ",",
      "a",
      ".dtstatdate",
      ")",
      "between",
      "0",
      "and",
      "7",
      "group",
      "by",
      "a",
      ".itype",
      ",",
      "a",
      ".dtstatdate",
      ",",
      "datediff",
      "(",
      "b",
      ".dtstatdate",
      ",",
      "a",
      ".dtstatdate",
      ")",
      ";"
    ],
    "query_toks_no_value": [
      "select",
      "a",
      ".itype",
      ",",
      "a",
      ".dtstatdate",
      ",",
      "datediff",
      "(",
      "b",
      ".dtstatdate",
      ",",
      "a",
      ".dtstatdate",
      ")",
      "as",
      "idaynum",
      ",",
      "count",
      "(",
      "distinct",
      "a",
      ".vplayerid",
      ")",
      "as",
      "iusernum",
      "from",
      "(",
      "select",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "as",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "(",
      "select",
      "value",
      "as",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "as",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "submodename",
      "=",
      "value",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "=",
      "value",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "vplayerid",
      ")",
      "t",
      "group",
      "by",
      "itype",
      ",",
      "vplayerid",
      ")",
      "a",
      "left",
      "join",
      "(",
      "select",
      "value",
      "as",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "submodename",
      "=",
      "value",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "=",
      "value",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      ")",
      "b",
      "on",
      "a",
      ".itype",
      "=",
      "b",
      ".itype",
      "and",
      "a",
      ".vplayerid",
      "=",
      "b",
      ".vplayerid",
      "where",
      "datediff",
      "(",
      "b",
      ".dtstatdate",
      ",",
      "a",
      ".dtstatdate",
      ")",
      "between",
      "value",
      "and",
      "value",
      "group",
      "by",
      "a",
      ".itype",
      ",",
      "a",
      ".dtstatdate",
      ",",
      "datediff",
      "(",
      "b",
      ".dtstatdate",
      ",",
      "a",
      ".dtstatdate",
      ")",
      ";"
    ],
    "question_toks": [
      "统计",
      "各个",
      "玩法",
      "上线",
      "首周",
      "留存",
      "情况",
      "\n",
      "输出",
      "：",
      "玩法",
      "、",
      "上线",
      "首周",
      "首次",
      "玩",
      "的",
      "日期",
      "、",
      "第几天",
      "留存",
      "（",
      "0",
      ",",
      "1",
      ",",
      "2",
      "...",
      "7",
      ")",
      "、",
      "玩法",
      "留存",
      "用户数",
      "\n",
      "\n",
      "各",
      "玩法",
      "首周",
      "上线",
      "日期",
      "：",
      "\n",
      "\"",
      "广域",
      "战场",
      "\"",
      ":",
      " ",
      "\"",
      "20240723",
      "\"",
      ",",
      "\n",
      "\"",
      "消灭",
      "战",
      "\"",
      ":",
      " ",
      "\"",
      "20230804",
      "\"",
      ",",
      "\n",
      "\"",
      "幻想",
      "混战",
      "\"",
      ":",
      " ",
      "\"",
      "20241115",
      "\"",
      ",",
      "\n",
      "\"",
      "荒野",
      "传说",
      "\"",
      ":",
      " ",
      "\"",
      "20240903",
      "\"",
      ",",
      "\n",
      "\"",
      "策略",
      "载具",
      "\"",
      ":",
      " ",
      "\"",
      "20241010",
      "\"",
      ",",
      "\n",
      "\"",
      "炎夏",
      "混战",
      "\"",
      ":",
      " ",
      "\"",
      "20240625",
      "\"",
      ",",
      "\n",
      "\"",
      "单人",
      "装备",
      "\"",
      ":",
      " ",
      "\"",
      "20240517",
      "\"",
      ",",
      "\n",
      "\"",
      "交叉",
      "堡垒",
      "\"",
      ":",
      " ",
      "\"",
      "20240412",
      "\""
    ],
    "sql": {
      "select": [
        false,
        [
          [
            "none",
            [
              "a",
              "itype"
            ]
          ],
          [
            "none",
            [
              "a",
              "dtstatdate"
            ]
          ],
          [
            "none",
            [
              "datediff",
              "b.dtstatdate,a.dtstatdate"
            ]
          ],
          [
            "count",
            [
              "distinct a",
              "vplayerid"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "("
          ]
        ],
        "conds": []
      },
      "where": [
        [
          false,
          ">=",
          [
            "none",
            [
              null,
              "dtstatdate"
            ],
            null
          ],
          [
            "string",
            "20240723"
          ],
          null
        ],
        "and",
        [
          false,
          "<=",
          [
            "none",
            [
              null,
              "dtstatdate"
            ],
            null
          ],
          [
            "function",
            [
              "date_add",
              "'20240723',6"
            ]
          ],
          null
        ],
        "and",
        [
          false,
          "=",
          [
            "none",
            [
              null,
              "submodename"
            ],
            null
          ],
          [
            "string",
            "广域战场模式"
          ],
          null
        ]
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": {
        "select": null,
        "from": null,
        "where": null,
        "groupBy": null,
        "orderBy": null,
        "having": null,
        "limit": null,
        "union": null,
        "intersect": null,
        "except": null
      },
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  },
  {
    "query": "with main_user as (\n    select substr(dtstatdate, 1, 6) mons,\n        case\n            when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n            when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n            when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n            when submodename = '广域战场模式' then '广域战场'\n            when submodename = '极能形态模式' then '极能形态'\n            when modename = '组队竞技' then '组竞'\n            when modename = '乐园' then '乐园'\n            when modename = '领地' then '领地'\n            when modename = '广阔天地' then '广阔天地'\n            else '其他模式'\n        end imodename,\n        vplayerid,\n        sum(roundtime) / 60 roundtime,\n        sum(roundcnt) roundcnt\n   from dws_jordass_mode_roundrecord_di\n   where dtstatdate between '20190508' and '20250330'\n   group by vplayerid, substr(dtstatdate, 1, 6),\n        case\n            when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿'\n            when modename = '传统模式' and mapname = '群屿' then '传统群屿'\n            when modename = '传统模式' and mapname = '假日群岛' then '假日群岛'\n            when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城'\n            when submodename = '广域战场模式' then '广域战场'\n            when submodename = '极能形态模式' then '极能形态'\n            when modename = '组队竞技' then '组竞'\n            when modename = '乐园' then '乐园'\n            when modename = '领地' then '领地'\n            when modename = '广阔天地' then '广阔天地'\n            else '其他模式'\n        end\n\n   union all\n   \n   select substr (tdbank_imp_date, 1, 6) mons,\n        '隧道' as modename,\n        vplayerid,\n        sum(roundtime) / 60 roundtime,\n        count(distinct gameid) roundcnt\n   from dwd_jordass_playerexitgamerecord_hi\n   where tdbank_imp_date between '2024061800' and '2025033023'\n     and mode in (3001, 3002, 3003)\n   group by substr (tdbank_imp_date, 1, 6), vplayerid\n)\n\nselect a.mons,\n       a.imodename,\n       a.iusernum,\n       b.iusernumall\nfrom (\n    select mons,\n          imodename,\n          count(vplayerid) iusernum\n    from (\n        select mons, vplayerid, imodename\n        from (\n            select mons,\n                vplayerid,\n                imodename,\n                roundtime,\n                row_number() over (partition by mons, vplayerid order by roundtime desc) as rn\n            from main_user\n        )ff1\n        where rn = 1\n    )f1\n   group by mons, imodename\n) a\nleft join (\n    select mons,\n        imodename,\n        count(vplayerid) iusernumall\n   from main_user\n   group by mons, imodename\n) b \non a.imodename = b.imodename and a.mons = b.mons\norder by a.mons, a.imodename\n;",
    "question": "统计2019.5.8至2025.3.30 分月的玩法主玩情况\n输出：月份(201905、201906、...、202503)、主玩玩法、主玩人数、总参与人数",
    "query_toks": [
      "with",
      "main_user",
      "as",
      "(",
      "select",
      "substr",
      "(",
      "dtstatdate",
      ",",
      "1",
      ",",
      "6",
      ")",
      "mons",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'荣耀之城'",
      "then",
      "'荣耀之城'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态'",
      "when",
      "modename",
      "=",
      "'组队竞技'",
      "then",
      "'组竞'",
      "when",
      "modename",
      "=",
      "'乐园'",
      "then",
      "'乐园'",
      "when",
      "modename",
      "=",
      "'领地'",
      "then",
      "'领地'",
      "when",
      "modename",
      "=",
      "'广阔天地'",
      "then",
      "'广阔天地'",
      "else",
      "'其他模式'",
      "end",
      "imodename",
      ",",
      "vplayerid",
      ",",
      "sum",
      "(",
      "roundtime",
      ")",
      "/",
      "60",
      "roundtime",
      ",",
      "sum",
      "(",
      "roundcnt",
      ")",
      "roundcnt",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "between",
      "'20190508'",
      "and",
      "'20250330'",
      "group",
      "by",
      "vplayerid",
      ",",
      "substr",
      "(",
      "dtstatdate",
      ",",
      "1",
      ",",
      "6",
      ")",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'荣耀之城'",
      "then",
      "'荣耀之城'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态'",
      "when",
      "modename",
      "=",
      "'组队竞技'",
      "then",
      "'组竞'",
      "when",
      "modename",
      "=",
      "'乐园'",
      "then",
      "'乐园'",
      "when",
      "modename",
      "=",
      "'领地'",
      "then",
      "'领地'",
      "when",
      "modename",
      "=",
      "'广阔天地'",
      "then",
      "'广阔天地'",
      "else",
      "'其他模式'",
      "end",
      "union",
      "all",
      "select",
      "substr",
      "(",
      "tdbank_imp_date",
      ",",
      "1",
      ",",
      "6",
      ")",
      "mons",
      ",",
      "'隧道'",
      "as",
      "modename",
      ",",
      "vplayerid",
      ",",
      "sum",
      "(",
      "roundtime",
      ")",
      "/",
      "60",
      "roundtime",
      ",",
      "count",
      "(",
      "distinct",
      "gameid",
      ")",
      "roundcnt",
      "from",
      "dwd_jordass_playerexitgamerecord_hi",
      "where",
      "tdbank_imp_date",
      "between",
      "'2024061800'",
      "and",
      "'2025033023'",
      "and",
      "mode",
      "in",
      "(",
      "3001",
      ",",
      "3002",
      ",",
      "3003",
      ")",
      "group",
      "by",
      "substr",
      "(",
      "tdbank_imp_date",
      ",",
      "1",
      ",",
      "6",
      ")",
      ",",
      "vplayerid",
      ")",
      "select",
      "a",
      ".mons",
      ",",
      "a",
      ".imodename",
      ",",
      "a",
      ".iusernum",
      ",",
      "b",
      ".iusernumall",
      "from",
      "(",
      "select",
      "mons",
      ",",
      "imodename",
      ",",
      "count",
      "(",
      "vplayerid",
      ")",
      "iusernum",
      "from",
      "(",
      "select",
      "mons",
      ",",
      "vplayerid",
      ",",
      "imodename",
      "from",
      "(",
      "select",
      "mons",
      ",",
      "vplayerid",
      ",",
      "imodename",
      ",",
      "roundtime",
      ",",
      "row_number",
      "(",
      ")",
      "over",
      "(",
      "partition",
      "by",
      "mons",
      ",",
      "vplayerid",
      "order",
      "by",
      "roundtime",
      "desc",
      ")",
      "as",
      "rn",
      "from",
      "main_user",
      ")",
      "ff1",
      "where",
      "rn",
      "=",
      "1",
      ")",
      "f1",
      "group",
      "by",
      "mons",
      ",",
      "imodename",
      ")",
      "a",
      "left",
      "join",
      "(",
      "select",
      "mons",
      ",",
      "imodename",
      ",",
      "count",
      "(",
      "vplayerid",
      ")",
      "iusernumall",
      "from",
      "main_user",
      "group",
      "by",
      "mons",
      ",",
      "imodename",
      ")",
      "b",
      "on",
      "a",
      ".imodename",
      "=",
      "b",
      ".imodename",
      "and",
      "a",
      ".mons",
      "=",
      "b",
      ".mons",
      "order",
      "by",
      "a",
      ".mons",
      ",",
      "a",
      ".imodename",
      ";"
    ],
    "query_toks_no_value": [
      "with",
      "main_user",
      "as",
      "(",
      "select",
      "substr",
      "(",
      "dtstatdate",
      ",",
      "value",
      ",",
      "value",
      ")",
      "mons",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      "imodename",
      ",",
      "vplayerid",
      ",",
      "sum",
      "(",
      "roundtime",
      ")",
      "/",
      "value",
      "roundtime",
      ",",
      "sum",
      "(",
      "roundcnt",
      ")",
      "roundcnt",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      "group",
      "by",
      "vplayerid",
      ",",
      "substr",
      "(",
      "dtstatdate",
      ",",
      "value",
      ",",
      "value",
      ")",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      "union",
      "all",
      "select",
      "substr",
      "(",
      "tdbank_imp_date",
      ",",
      "value",
      ",",
      "value",
      ")",
      "mons",
      ",",
      "value",
      "as",
      "modename",
      ",",
      "vplayerid",
      ",",
      "sum",
      "(",
      "roundtime",
      ")",
      "/",
      "value",
      "roundtime",
      ",",
      "count",
      "(",
      "distinct",
      "gameid",
      ")",
      "roundcnt",
      "from",
      "dwd_jordass_playerexitgamerecord_hi",
      "where",
      "tdbank_imp_date",
      "between",
      "value",
      "and",
      "value",
      "and",
      "mode",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "substr",
      "(",
      "tdbank_imp_date",
      ",",
      "value",
      ",",
      "value",
      ")",
      ",",
      "vplayerid",
      ")",
      "select",
      "a",
      ".mons",
      ",",
      "a",
      ".imodename",
      ",",
      "a",
      ".iusernum",
      ",",
      "b",
      ".iusernumall",
      "from",
      "(",
      "select",
      "mons",
      ",",
      "imodename",
      ",",
      "count",
      "(",
      "vplayerid",
      ")",
      "iusernum",
      "from",
      "(",
      "select",
      "mons",
      ",",
      "vplayerid",
      ",",
      "imodename",
      "from",
      "(",
      "select",
      "mons",
      ",",
      "vplayerid",
      ",",
      "imodename",
      ",",
      "roundtime",
      ",",
      "row_number",
      "(",
      ")",
      "over",
      "(",
      "partition",
      "by",
      "mons",
      ",",
      "vplayerid",
      "order",
      "by",
      "roundtime",
      "desc",
      ")",
      "as",
      "rn",
      "from",
      "main_user",
      ")",
      "ff1",
      "where",
      "rn",
      "=",
      "value",
      ")",
      "f1",
      "group",
      "by",
      "mons",
      ",",
      "imodename",
      ")",
      "a",
      "left",
      "join",
      "(",
      "select",
      "mons",
      ",",
      "imodename",
      ",",
      "count",
      "(",
      "vplayerid",
      ")",
      "iusernumall",
      "from",
      "main_user",
      "group",
      "by",
      "mons",
      ",",
      "imodename",
      ")",
      "b",
      "on",
      "a",
      ".imodename",
      "=",
      "b",
      ".imodename",
      "and",
      "a",
      ".mons",
      "=",
      "b",
      ".mons",
      "order",
      "by",
      "a",
      ".mons",
      ",",
      "a",
      ".imodename",
      ";"
    ],
    "question_toks": [
      "统计",
      "2019.5",
      ".",
      "8",
      "至",
      "2025.3",
      ".",
      "30",
      " ",
      "分月",
      "的",
      "玩法",
      "主玩",
      "情况",
      "\n",
      "输出",
      "：",
      "月份",
      "(",
      "201905",
      "、",
      "201906",
      "、",
      "...",
      "、",
      "202503",
      ")",
      "、",
      "主",
      "玩玩",
      "法",
      "、",
      "主玩",
      "人数",
      "、",
      "总",
      "参与",
      "人数"
    ],
    "sql": {
      "select": [
        false,
        [
          [
            "none",
            [
              "substr",
              "dtstatdate, 1, 6"
            ]
          ],
          [
            "none",
            [
              null,
              "case when modename = '传统模式' and submodename like 'CG%' and mapname = '群屿' then '主题群屿' when modename = '传统模式' and mapname = '群屿' then '传统群屿' when modename = '传统模式' and mapname = '假日群岛' then '假日群岛' when modename = '传统模式' and mapname = '荣耀之城' then '荣耀之城' when submodename = '广域战场模式' then '广域战场' when submodename = '极能形态模式' then '极能形态' when modename = '组队竞技' then '组竞' when modename = '乐园' then '乐园' when modename = '领地' then '领地' when modename = '广阔天地' then '广阔天地' else '其他模式' end imodename"
            ]
          ],
          [
            "none",
            [
              null,
              "vplayerid"
            ]
          ],
          [
            "sum",
            [
              null,
              "roundtime"
            ]
          ],
          [
            "sum",
            [
              null,
              "roundcnt"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "dws_jordass_mode_roundrecord_di"
          ]
        ],
        "conds": []
      },
      "where": [
        [
          false,
          "between",
          [
            "none",
            [
              null,
              "dtstatdate"
            ],
            null
          ],
          [
            "string",
            "20190508"
          ],
          null
        ],
        "and",
        "'20250330'"
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": {
        "select": null,
        "from": null,
        "where": null,
        "groupBy": null,
        "orderBy": null,
        "having": null,
        "limit": null,
        "union": null,
        "intersect": null,
        "except": null
      },
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  },
  {
    "query": "select\n    count(distinct a.vplayerid) as total_players,\n    count(distinct case when b.vplayerid is not null then a.vplayerid end) as existing_players,\n    count(distinct case when b.vplayerid is null then a.vplayerid end) as new_players\nfrom (\n    select vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20241214' and '20241220'\n    and imode = 1344338933661592832\n    and platid = 255\n    group by vplayerid\n) a\nleft join (\n    select vplayerid\n    from dws_jordass_playermatchrecord_stat_df\n    where dtstatdate = '20241213'\n    and imode = 1344338933661592832\n    and platid = 255\n    group by vplayerid\n) b\non a.vplayerid = b.vplayerid\n;",
    "question": "统计2024年12月14日-2024年12月20日参与建筑争夺玩法的玩家人数（去重）有多少，其中多少人是12月13日及以前有参与过建筑争夺的老玩家，有多少是新玩家\n输出: 玩家人数、老玩家人数、新玩家人数",
    "query_toks": [
      "select",
      "count",
      "(",
      "distinct",
      "a",
      ".vplayerid",
      ")",
      "as",
      "total_players",
      ",",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "b",
      ".vplayerid",
      "is",
      "not",
      "null",
      "then",
      "a",
      ".vplayerid",
      "end",
      ")",
      "as",
      "existing_players",
      ",",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "b",
      ".vplayerid",
      "is",
      "null",
      "then",
      "a",
      ".vplayerid",
      "end",
      ")",
      "as",
      "new_players",
      "from",
      "(",
      "select",
      "vplayerid",
      "from",
      "dws_jordass_matchlog_stat_di",
      "where",
      "dtstatdate",
      "between",
      "'20241214'",
      "and",
      "'20241220'",
      "and",
      "imode",
      "=",
      "1344338933661592832",
      "and",
      "platid",
      "=",
      "255",
      "group",
      "by",
      "vplayerid",
      ")",
      "a",
      "left",
      "join",
      "(",
      "select",
      "vplayerid",
      "from",
      "dws_jordass_playermatchrecord_stat_df",
      "where",
      "dtstatdate",
      "=",
      "'20241213'",
      "and",
      "imode",
      "=",
      "1344338933661592832",
      "and",
      "platid",
      "=",
      "255",
      "group",
      "by",
      "vplayerid",
      ")",
      "b",
      "on",
      "a",
      ".vplayerid",
      "=",
      "b",
      ".vplayerid",
      ";"
    ],
    "query_toks_no_value": [
      "select",
      "count",
      "(",
      "distinct",
      "a",
      ".vplayerid",
      ")",
      "as",
      "total_players",
      ",",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "b",
      ".vplayerid",
      "is",
      "not",
      "null",
      "then",
      "a",
      ".vplayerid",
      "end",
      ")",
      "as",
      "existing_players",
      ",",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "b",
      ".vplayerid",
      "is",
      "null",
      "then",
      "a",
      ".vplayerid",
      "end",
      ")",
      "as",
      "new_players",
      "from",
      "(",
      "select",
      "vplayerid",
      "from",
      "dws_jordass_matchlog_stat_di",
      "where",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      "and",
      "imode",
      "=",
      "value",
      "and",
      "platid",
      "=",
      "value",
      "group",
      "by",
      "vplayerid",
      ")",
      "a",
      "left",
      "join",
      "(",
      "select",
      "vplayerid",
      "from",
      "dws_jordass_playermatchrecord_stat_df",
      "where",
      "dtstatdate",
      "=",
      "value",
      "and",
      "imode",
      "=",
      "value",
      "and",
      "platid",
      "=",
      "value",
      "group",
      "by",
      "vplayerid",
      ")",
      "b",
      "on",
      "a",
      ".vplayerid",
      "=",
      "b",
      ".vplayerid",
      ";"
    ],
    "question_toks": [
      "统计",
      "2024",
      "年",
      "12",
      "月",
      "14",
      "日",
      "-",
      "2024",
      "年",
      "12",
      "月",
      "20",
      "日",
      "参与",
      "建筑",
      "争夺",
      "玩法",
      "的",
      "玩家",
      "人数",
      "（",
      "去",
      "重",
      "）",
      "有",
      "多少",
      "，",
      "其中",
      "多少",
      "人",
      "是",
      "12",
      "月",
      "13",
      "日及",
      "以前",
      "有",
      "参与",
      "过",
      "建筑",
      "争夺",
      "的",
      "老",
      "玩家",
      "，",
      "有",
      "多少",
      "是",
      "新",
      "玩家",
      "\n",
      "输出",
      ":",
      " ",
      "玩家",
      "人数",
      "、",
      "老",
      "玩家",
      "人数",
      "、",
      "新",
      "玩家",
      "人数"
    ],
    "sql": {
      "select": [
        false,
        [
          [
            "count",
            [
              "distinct a",
              "vplayerid"
            ]
          ],
          [
            "count",
            [
              "distinct case when b",
              "vplayerid is not null then a.vplayerid end"
            ]
          ],
          [
            "count",
            [
              "distinct case when b",
              "vplayerid is null then a.vplayerid end"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "("
          ]
        ],
        "conds": []
      },
      "where": [
        [
          false,
          "between",
          [
            "none",
            [
              null,
              "dtstatdate"
            ],
            null
          ],
          [
            "string",
            "20241214"
          ],
          null
        ],
        "and",
        "'20241220'",
        "and",
        [
          false,
          "=",
          [
            "none",
            [
              null,
              "imode"
            ],
            null
          ],
          [
            "number",
            1.3443389336615928e+18
          ],
          null
        ],
        "and",
        [
          false,
          "=",
          [
            "none",
            [
              null,
              "platid"
            ],
            null
          ],
          [
            "number",
            255.0
          ],
          null
        ]
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": null,
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  },
  {
    "query": "select\n    ds,\n    count(distinct vplayerid) as user_cnt,\n    count(distinct vplayerid, irank) as user_times\nfrom (\n    select\n        s2.ds,\n        s2.vplayerid,\n        s2.irank\n    from (\n        -- 获取411111事件（点击按钮）\n        select\n            dtstatdate as ds,\n            vplayerid,\n            dteventtime\n        from dws_jordass_buttonpress_pre_di\n        where buttontype = 411111\n        and  ((dtstatdate between '20240917' and '20240923') or (dtstatdate between '20241008' and '20241014'))\n    ) s1\n    join (\n        -- 获取411120事件（加入玩法）并编号\n        select\n            dtstatdate as ds,\n            vplayerid,\n            dteventtime,\n            row_number() over (partition by vplayerid order by dteventtime) as irank\n        from dws_jordass_buttonpress_pre_di\n        where buttontype = 411120\n        and ((dtstatdate between '20240917' and '20240923') or (dtstatdate between '20241008' and '20241014'))\n    ) s2 on s1.vplayerid = s2.vplayerid and s1.ds = s2.ds and s2.dteventtime > s1.dteventtime\n    join (\n        -- 获取411123事件（确认动作）\n        select\n            dtstatdate as ds,\n            vplayerid,\n            dteventtime\n        from dws_jordass_buttonpress_pre_di\n        where buttontype = 411123\n        and ((dtstatdate between '20240917' and '20240923') or (dtstatdate between '20241008' and '20241014'))\n    ) s3 on s2.vplayerid = s3.vplayerid and s2.ds = s3.ds and s3.dteventtime > s2.dteventtime\n)f \ngroup by ds\n;",
    "question": "统计2024.9.17-2024.9.23 和 2024.10.8-2024.10.14    每天点击按钮后加入玩法，再之后点击确认的人数，以及这些人加入玩法的次数                                                       \n输出：日期(20240917、...、20240923、20241008、...、20241014)，人数，人次",
    "query_toks": [
      "select",
      "ds",
      ",",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      "as",
      "user_cnt",
      ",",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ",",
      "irank",
      ")",
      "as",
      "user_times",
      "from",
      "(",
      "select",
      "s2",
      ".ds",
      ",",
      "s2",
      ".vplayerid",
      ",",
      "s2",
      ".irank",
      "from",
      "(",
      "-",
      "-",
      "获取411111事件",
      "（",
      "点击按钮",
      "）",
      "select",
      "dtstatdate",
      "as",
      "ds",
      ",",
      "vplayerid",
      ",",
      "dteventtime",
      "from",
      "dws_jordass_buttonpress_pre_di",
      "where",
      "buttontype",
      "=",
      "411111",
      "and",
      "(",
      "(",
      "dtstatdate",
      "between",
      "'20240917'",
      "and",
      "'20240923'",
      ")",
      "or",
      "(",
      "dtstatdate",
      "between",
      "'20241008'",
      "and",
      "'20241014'",
      ")",
      ")",
      ")",
      "s1",
      "join",
      "(",
      "-",
      "-",
      "获取411120事件",
      "（",
      "加入玩法",
      "）",
      "并编号",
      "select",
      "dtstatdate",
      "as",
      "ds",
      ",",
      "vplayerid",
      ",",
      "dteventtime",
      ",",
      "row_number",
      "(",
      ")",
      "over",
      "(",
      "partition",
      "by",
      "vplayerid",
      "order",
      "by",
      "dteventtime",
      ")",
      "as",
      "irank",
      "from",
      "dws_jordass_buttonpress_pre_di",
      "where",
      "buttontype",
      "=",
      "411120",
      "and",
      "(",
      "(",
      "dtstatdate",
      "between",
      "'20240917'",
      "and",
      "'20240923'",
      ")",
      "or",
      "(",
      "dtstatdate",
      "between",
      "'20241008'",
      "and",
      "'20241014'",
      ")",
      ")",
      ")",
      "s2",
      "on",
      "s1",
      ".vplayerid",
      "=",
      "s2",
      ".vplayerid",
      "and",
      "s1",
      ".ds",
      "=",
      "s2",
      ".ds",
      "and",
      "s2",
      ".dteventtime",
      ">",
      "s1",
      ".dteventtime",
      "join",
      "(",
      "-",
      "-",
      "获取411123事件",
      "（",
      "确认动作",
      "）",
      "select",
      "dtstatdate",
      "as",
      "ds",
      ",",
      "vplayerid",
      ",",
      "dteventtime",
      "from",
      "dws_jordass_buttonpress_pre_di",
      "where",
      "buttontype",
      "=",
      "411123",
      "and",
      "(",
      "(",
      "dtstatdate",
      "between",
      "'20240917'",
      "and",
      "'20240923'",
      ")",
      "or",
      "(",
      "dtstatdate",
      "between",
      "'20241008'",
      "and",
      "'20241014'",
      ")",
      ")",
      ")",
      "s3",
      "on",
      "s2",
      ".vplayerid",
      "=",
      "s3",
      ".vplayerid",
      "and",
      "s2",
      ".ds",
      "=",
      "s3",
      ".ds",
      "and",
      "s3",
      ".dteventtime",
      ">",
      "s2",
      ".dteventtime",
      ")",
      "f",
      "group",
      "by",
      "ds",
      ";"
    ],
    "query_toks_no_value": [
      "select",
      "ds",
      ",",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      "as",
      "user_cnt",
      ",",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ",",
      "irank",
      ")",
      "as",
      "user_times",
      "from",
      "(",
      "select",
      "s2",
      ".ds",
      ",",
      "s2",
      ".vplayerid",
      ",",
      "s2",
      ".irank",
      "from",
      "(",
      "-",
      "-",
      "获取411111事件",
      "（",
      "点击按钮",
      "）",
      "select",
      "dtstatdate",
      "as",
      "ds",
      ",",
      "vplayerid",
      ",",
      "dteventtime",
      "from",
      "dws_jordass_buttonpress_pre_di",
      "where",
      "buttontype",
      "=",
      "value",
      "and",
      "(",
      "(",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      ")",
      "or",
      "(",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      ")",
      ")",
      ")",
      "s1",
      "join",
      "(",
      "-",
      "-",
      "获取411120事件",
      "（",
      "加入玩法",
      "）",
      "并编号",
      "select",
      "dtstatdate",
      "as",
      "ds",
      ",",
      "vplayerid",
      ",",
      "dteventtime",
      ",",
      "row_number",
      "(",
      ")",
      "over",
      "(",
      "partition",
      "by",
      "vplayerid",
      "order",
      "by",
      "dteventtime",
      ")",
      "as",
      "irank",
      "from",
      "dws_jordass_buttonpress_pre_di",
      "where",
      "buttontype",
      "=",
      "value",
      "and",
      "(",
      "(",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      ")",
      "or",
      "(",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      ")",
      ")",
      ")",
      "s2",
      "on",
      "s1",
      ".vplayerid",
      "=",
      "s2",
      ".vplayerid",
      "and",
      "s1",
      ".ds",
      "=",
      "s2",
      ".ds",
      "and",
      "s2",
      ".dteventtime",
      ">",
      "s1",
      ".dteventtime",
      "join",
      "(",
      "-",
      "-",
      "获取411123事件",
      "（",
      "确认动作",
      "）",
      "select",
      "dtstatdate",
      "as",
      "ds",
      ",",
      "vplayerid",
      ",",
      "dteventtime",
      "from",
      "dws_jordass_buttonpress_pre_di",
      "where",
      "buttontype",
      "=",
      "value",
      "and",
      "(",
      "(",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      ")",
      "or",
      "(",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      ")",
      ")",
      ")",
      "s3",
      "on",
      "s2",
      ".vplayerid",
      "=",
      "s3",
      ".vplayerid",
      "and",
      "s2",
      ".ds",
      "=",
      "s3",
      ".ds",
      "and",
      "s3",
      ".dteventtime",
      ">",
      "s2",
      ".dteventtime",
      ")",
      "f",
      "group",
      "by",
      "ds",
      ";"
    ],
    "question_toks": [
      "统计",
      "2024.9",
      ".",
      "17",
      "-",
      "2024.9",
      ".",
      "23",
      " ",
      "和",
      " ",
      "2024.10",
      ".",
      "8",
      "-",
      "2024.10",
      ".",
      "14",
      " ",
      " ",
      " ",
      " ",
      "每天",
      "点击",
      "按钮",
      "后",
      "加入",
      "玩法",
      "，",
      "再",
      "之后",
      "点击",
      "确认",
      "的",
      "人数",
      "，",
      "以及",
      "这些",
      "人",
      "加入",
      "玩法",
      "的",
      "次数",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      " ",
      "\n",
      "输出",
      "：",
      "日期",
      "(",
      "20240917",
      "、",
      "...",
      "、",
      "20240923",
      "、",
      "20241008",
      "、",
      "...",
      "、",
      "20241014",
      ")",
      "，",
      "人数",
      "，",
      "人次"
    ],
    "sql": {
      "select": [
        false,
        [
          [
            "none",
            [
              null,
              "ds"
            ]
          ],
          [
            "count",
            [
              null,
              "distinct vplayerid"
            ]
          ],
          [
            "count",
            [
              null,
              "distinct vplayerid, irank"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "("
          ]
        ],
        "conds": []
      },
      "where": [
        [
          false,
          "=",
          [
            "none",
            [
              null,
              "buttontype"
            ],
            null
          ],
          [
            "number",
            411111.0
          ],
          null
        ],
        "and",
        [
          false,
          "between",
          [
            "none",
            [
              null,
              "((dtstatdate"
            ],
            null
          ],
          [
            "string",
            "20240917"
          ],
          [
            "column",
            [
              null,
              "'20240923') or (dtstatdate"
            ]
          ]
        ]
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": null,
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  },
  {
    "query": "with round_user as (\n    select dtstatdate,\n        case \n            when mode in (401,402,403) then '第一人称'\n            when mode =101 then '单排'\n            when mode =102 then '双排'\n            when mode in (103,603) then '四排'\n        end modename,\n        vplayerid,\n        sum(roundcnt) roundcnt,\n        sum(roundtime) roundtime\n    from dws_jordass_mode_roundrecord_di\n    where ((dtstatdate between '20240326' and '20240409')\n    or (dtstatdate between '20240528' and '20240611'))\n    and mode in (401,402,403,101,102,103,603)\n    group by dtstatdate,\n    case when mode in (401,402,403) then '第一人称'\n        when mode =101 then '单排'\n        when mode =102 then '双排'\n        when mode in (103,603) then '四排'\n    end,\n    vplayerid\n)\n\nselect \n    a.dtstatdate,\n    a.modename,\n    count(distinct a.vplayerid) iusernum,\n    sum(a.roundcnt) roundcnt,\n    sum(a.roundtime) roundtime,\n    count(distinct b1.vplayerid) stay2,\n    count(distinct b2.vplayerid) stay7,\n    count(distinct c1.vplayerid) playstay2,\n    count(distinct c2.vplayerid) playstay7\nfrom (\n    select * from round_user \n    where((dtstatdate between '20240326' and '20240403') or (dtstatdate between '20240528' and '20240605'))\n) a\nleft join (\n    select dtstatdate,vplayerid \n    from dws_jordass_login_di\n    where ((dtstatdate between '20240326' and '20240404') or (dtstatdate between '20240528' and '20240606')) \n    and platid =255\n    group by dtstatdate,vplayerid\n) b1 \non a.vplayerid = b1.vplayerid and date_add(a.dtstatdate,1) = b1.dtstatdate\nleft join (\n    select dtstatdate,vplayerid \n    from dws_jordass_login_di\n    where ((dtstatdate between '20240326' and '20240409') or (dtstatdate between '20240528' and '20240611')) and platid =255\n    group by dtstatdate,vplayerid\n) b2 \non a.vplayerid = b2.vplayerid and date_add(a.dtstatdate,6) = b2.dtstatdate\nleft join round_user c1 \non a.vplayerid = c1.vplayerid and date_add(a.dtstatdate,1) = c1.dtstatdate and a.modename= c1.modename\nleft join round_user c2 \non a.vplayerid = c2.vplayerid and date_add(a.dtstatdate,6) = c2.dtstatdate and a.modename= c2.modename\ngroup by a.dtstatdate,a.modename\n;",
    "question": "统计2024年3月26日~4月3日\n2024年5月28日~6月5日\n不同对局类型的游戏和玩法留存情况\n输出：统计日期(20240326、...、20240403、20240528、...、20240605)、对局类型（第一人称、单排、双排、四排），每日对局人数、次数、对局总时长(秒)、游戏次留人数、游戏7留人数，玩法次留人数、玩法7留人数",
    "query_toks": [
      "with",
      "round_user",
      "as",
      "(",
      "select",
      "dtstatdate",
      ",",
      "case",
      "when",
      "mode",
      "in",
      "(",
      "401",
      ",",
      "402",
      ",",
      "403",
      ")",
      "then",
      "'第一人称'",
      "when",
      "mode",
      "=",
      "101",
      "then",
      "'单排'",
      "when",
      "mode",
      "=",
      "102",
      "then",
      "'双排'",
      "when",
      "mode",
      "in",
      "(",
      "103",
      ",",
      "603",
      ")",
      "then",
      "'四排'",
      "end",
      "modename",
      ",",
      "vplayerid",
      ",",
      "sum",
      "(",
      "roundcnt",
      ")",
      "roundcnt",
      ",",
      "sum",
      "(",
      "roundtime",
      ")",
      "roundtime",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "(",
      "(",
      "dtstatdate",
      "between",
      "'20240326'",
      "and",
      "'20240409'",
      ")",
      "or",
      "(",
      "dtstatdate",
      "between",
      "'20240528'",
      "and",
      "'20240611'",
      ")",
      ")",
      "and",
      "mode",
      "in",
      "(",
      "401",
      ",",
      "402",
      ",",
      "403",
      ",",
      "101",
      ",",
      "102",
      ",",
      "103",
      ",",
      "603",
      ")",
      "group",
      "by",
      "dtstatdate",
      ",",
      "case",
      "when",
      "mode",
      "in",
      "(",
      "401",
      ",",
      "402",
      ",",
      "403",
      ")",
      "then",
      "'第一人称'",
      "when",
      "mode",
      "=",
      "101",
      "then",
      "'单排'",
      "when",
      "mode",
      "=",
      "102",
      "then",
      "'双排'",
      "when",
      "mode",
      "in",
      "(",
      "103",
      ",",
      "603",
      ")",
      "then",
      "'四排'",
      "end",
      ",",
      "vplayerid",
      ")",
      "select",
      "a",
      ".dtstatdate",
      ",",
      "a",
      ".modename",
      ",",
      "count",
      "(",
      "distinct",
      "a",
      ".vplayerid",
      ")",
      "iusernum",
      ",",
      "sum",
      "(",
      "a",
      ".roundcnt",
      ")",
      "roundcnt",
      ",",
      "sum",
      "(",
      "a",
      ".roundtime",
      ")",
      "roundtime",
      ",",
      "count",
      "(",
      "distinct",
      "b1",
      ".vplayerid",
      ")",
      "stay2",
      ",",
      "count",
      "(",
      "distinct",
      "b2",
      ".vplayerid",
      ")",
      "stay7",
      ",",
      "count",
      "(",
      "distinct",
      "c1",
      ".vplayerid",
      ")",
      "playstay2",
      ",",
      "count",
      "(",
      "distinct",
      "c2",
      ".vplayerid",
      ")",
      "playstay7",
      "from",
      "(",
      "select",
      "*",
      "from",
      "round_user",
      "where",
      "(",
      "(",
      "dtstatdate",
      "between",
      "'20240326'",
      "and",
      "'20240403'",
      ")",
      "or",
      "(",
      "dtstatdate",
      "between",
      "'20240528'",
      "and",
      "'20240605'",
      ")",
      ")",
      ")",
      "a",
      "left",
      "join",
      "(",
      "select",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_login_di",
      "where",
      "(",
      "(",
      "dtstatdate",
      "between",
      "'20240326'",
      "and",
      "'20240404'",
      ")",
      "or",
      "(",
      "dtstatdate",
      "between",
      "'20240528'",
      "and",
      "'20240606'",
      ")",
      ")",
      "and",
      "platid",
      "=",
      "255",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      ")",
      "b1",
      "on",
      "a",
      ".vplayerid",
      "=",
      "b1",
      ".vplayerid",
      "and",
      "date_add",
      "(",
      "a",
      ".dtstatdate",
      ",",
      "1",
      ")",
      "=",
      "b1",
      ".dtstatdate",
      "left",
      "join",
      "(",
      "select",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_login_di",
      "where",
      "(",
      "(",
      "dtstatdate",
      "between",
      "'20240326'",
      "and",
      "'20240409'",
      ")",
      "or",
      "(",
      "dtstatdate",
      "between",
      "'20240528'",
      "and",
      "'20240611'",
      ")",
      ")",
      "and",
      "platid",
      "=",
      "255",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      ")",
      "b2",
      "on",
      "a",
      ".vplayerid",
      "=",
      "b2",
      ".vplayerid",
      "and",
      "date_add",
      "(",
      "a",
      ".dtstatdate",
      ",",
      "6",
      ")",
      "=",
      "b2",
      ".dtstatdate",
      "left",
      "join",
      "round_user",
      "c1",
      "on",
      "a",
      ".vplayerid",
      "=",
      "c1",
      ".vplayerid",
      "and",
      "date_add",
      "(",
      "a",
      ".dtstatdate",
      ",",
      "1",
      ")",
      "=",
      "c1",
      ".dtstatdate",
      "and",
      "a",
      ".modename",
      "=",
      "c1",
      ".modename",
      "left",
      "join",
      "round_user",
      "c2",
      "on",
      "a",
      ".vplayerid",
      "=",
      "c2",
      ".vplayerid",
      "and",
      "date_add",
      "(",
      "a",
      ".dtstatdate",
      ",",
      "6",
      ")",
      "=",
      "c2",
      ".dtstatdate",
      "and",
      "a",
      ".modename",
      "=",
      "c2",
      ".modename",
      "group",
      "by",
      "a",
      ".dtstatdate",
      ",",
      "a",
      ".modename",
      ";"
    ],
    "query_toks_no_value": [
      "with",
      "round_user",
      "as",
      "(",
      "select",
      "dtstatdate",
      ",",
      "case",
      "when",
      "mode",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "value",
      "when",
      "mode",
      "=",
      "value",
      "then",
      "value",
      "when",
      "mode",
      "=",
      "value",
      "then",
      "value",
      "when",
      "mode",
      "in",
      "(",
      "value",
      ",",
      "value",
      ")",
      "then",
      "value",
      "end",
      "modename",
      ",",
      "vplayerid",
      ",",
      "sum",
      "(",
      "roundcnt",
      ")",
      "roundcnt",
      ",",
      "sum",
      "(",
      "roundtime",
      ")",
      "roundtime",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "(",
      "(",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      ")",
      "or",
      "(",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      ")",
      ")",
      "and",
      "mode",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "dtstatdate",
      ",",
      "case",
      "when",
      "mode",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "value",
      "when",
      "mode",
      "=",
      "value",
      "then",
      "value",
      "when",
      "mode",
      "=",
      "value",
      "then",
      "value",
      "when",
      "mode",
      "in",
      "(",
      "value",
      ",",
      "value",
      ")",
      "then",
      "value",
      "end",
      ",",
      "vplayerid",
      ")",
      "select",
      "a",
      ".dtstatdate",
      ",",
      "a",
      ".modename",
      ",",
      "count",
      "(",
      "distinct",
      "a",
      ".vplayerid",
      ")",
      "iusernum",
      ",",
      "sum",
      "(",
      "a",
      ".roundcnt",
      ")",
      "roundcnt",
      ",",
      "sum",
      "(",
      "a",
      ".roundtime",
      ")",
      "roundtime",
      ",",
      "count",
      "(",
      "distinct",
      "b1",
      ".vplayerid",
      ")",
      "stay2",
      ",",
      "count",
      "(",
      "distinct",
      "b2",
      ".vplayerid",
      ")",
      "stay7",
      ",",
      "count",
      "(",
      "distinct",
      "c1",
      ".vplayerid",
      ")",
      "playstay2",
      ",",
      "count",
      "(",
      "distinct",
      "c2",
      ".vplayerid",
      ")",
      "playstay7",
      "from",
      "(",
      "select",
      "*",
      "from",
      "round_user",
      "where",
      "(",
      "(",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      ")",
      "or",
      "(",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      ")",
      ")",
      ")",
      "a",
      "left",
      "join",
      "(",
      "select",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_login_di",
      "where",
      "(",
      "(",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      ")",
      "or",
      "(",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      ")",
      ")",
      "and",
      "platid",
      "=",
      "value",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      ")",
      "b1",
      "on",
      "a",
      ".vplayerid",
      "=",
      "b1",
      ".vplayerid",
      "and",
      "date_add",
      "(",
      "a",
      ".dtstatdate",
      ",",
      "value",
      ")",
      "=",
      "b1",
      ".dtstatdate",
      "left",
      "join",
      "(",
      "select",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_login_di",
      "where",
      "(",
      "(",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      ")",
      "or",
      "(",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      ")",
      ")",
      "and",
      "platid",
      "=",
      "value",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      ")",
      "b2",
      "on",
      "a",
      ".vplayerid",
      "=",
      "b2",
      ".vplayerid",
      "and",
      "date_add",
      "(",
      "a",
      ".dtstatdate",
      ",",
      "value",
      ")",
      "=",
      "b2",
      ".dtstatdate",
      "left",
      "join",
      "round_user",
      "c1",
      "on",
      "a",
      ".vplayerid",
      "=",
      "c1",
      ".vplayerid",
      "and",
      "date_add",
      "(",
      "a",
      ".dtstatdate",
      ",",
      "value",
      ")",
      "=",
      "c1",
      ".dtstatdate",
      "and",
      "a",
      ".modename",
      "=",
      "c1",
      ".modename",
      "left",
      "join",
      "round_user",
      "c2",
      "on",
      "a",
      ".vplayerid",
      "=",
      "c2",
      ".vplayerid",
      "and",
      "date_add",
      "(",
      "a",
      ".dtstatdate",
      ",",
      "value",
      ")",
      "=",
      "c2",
      ".dtstatdate",
      "and",
      "a",
      ".modename",
      "=",
      "c2",
      ".modename",
      "group",
      "by",
      "a",
      ".dtstatdate",
      ",",
      "a",
      ".modename",
      ";"
    ],
    "question_toks": [
      "统计",
      "2024",
      "年",
      "3",
      "月",
      "26",
      "日",
      "~",
      "4",
      "月",
      "3",
      "日",
      "\n",
      "2024",
      "年",
      "5",
      "月",
      "28",
      "日",
      "~",
      "6",
      "月",
      "5",
      "日",
      "\n",
      "不同",
      "对局",
      "类型",
      "的",
      "游戏",
      "和",
      "玩法",
      "留存",
      "情况",
      "\n",
      "输出",
      "：",
      "统计",
      "日期",
      "(",
      "20240326",
      "、",
      "...",
      "、",
      "20240403",
      "、",
      "20240528",
      "、",
      "...",
      "、",
      "20240605",
      ")",
      "、",
      "对局",
      "类型",
      "（",
      "第一人称",
      "、",
      "单排",
      "、",
      "双排",
      "、",
      "四排",
      "）",
      "，",
      "每日",
      "对局",
      "人数",
      "、",
      "次数",
      "、",
      "对局",
      "总时长",
      "(",
      "秒",
      ")",
      "、",
      "游戏",
      "次留",
      "人数",
      "、",
      "游戏",
      "7",
      "留",
      "人数",
      "，",
      "玩法",
      "次留",
      "人数",
      "、",
      "玩法",
      "7",
      "留",
      "人数"
    ],
    "sql": {
      "select": [
        false,
        [
          [
            "none",
            [
              null,
              "dtstatdate"
            ]
          ],
          [
            "none",
            [
              null,
              "case when mode in (401,402,403) then '第一人称' when mode =101 then '单排' when mode =102 then '双排' when mode in (103,603) then '四排' end modename"
            ]
          ],
          [
            "none",
            [
              null,
              "vplayerid"
            ]
          ],
          [
            "sum",
            [
              null,
              "roundcnt"
            ]
          ],
          [
            "sum",
            [
              null,
              "roundtime"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "dws_jordass_mode_roundrecord_di"
          ]
        ],
        "conds": []
      },
      "where": [
        [
          false,
          "between",
          [
            "none",
            [
              null,
              "((dtstatdate"
            ],
            null
          ],
          [
            "string",
            "20240326"
          ],
          [
            "column",
            [
              null,
              "'20240409') or (dtstatdate"
            ]
          ]
        ],
        "and",
        [
          false,
          "in",
          [
            "none",
            [
              null,
              "mode"
            ],
            null
          ],
          [
            "sql",
            {
              "select": null,
              "from": null,
              "where": null,
              "groupBy": null,
              "orderBy": null,
              "having": null,
              "limit": null,
              "union": null,
              "intersect": null,
              "except": null
            }
          ],
          null
        ]
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": null,
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  },
  {
    "query": "select \n    s1.ds as `ds`, -- 日期\n    count(distinct s1.vplayerid) as `user_cnt`, -- 人数\n    coalesce(user_type, '未知') as `user_type`, -- 用户类型\n    count(distinct case when s2.ds = date_add(s1.ds, 1) then s1.vplayerid else null end) as `next_day_retention`, -- 次留人数\n    count(distinct case when s2.ds = date_add(s1.ds, 2) then s1.vplayerid else null end) as `three_day_retention`, -- 三留人数\n    count(distinct case when s2.ds = date_add(s1.ds, 6) then s1.vplayerid else null end) as `seven_day_retention`, -- 七留人数\n    count(distinct case when s2.ds = date_add(s1.ds, 13) then s1.vplayerid else null end) as `fourteen_day_retention`, -- 14留人数\n    count(distinct case when s2.ds = date_add(s1.ds, 29) then s1.vplayerid else null end) as `thirty_day_retention` -- 30留人数\nfrom (\n    select \n        f1.dregdate as ds,  -- 日期\n        f1.vplayerid as vplayerid  -- 用户id\n    from  dws_jordass_emulator_df f1\n    where   f1.dtstatdate = '20251001'  \n        and f1.dregdate >= '20250401'  \n        and f1.dregdate <= '20250530'  \n        and f1.platid = 255  \n) s1\nleft join (\n    select \n        f1.dtstatdate as ds, -- 统计日期\n        f1.vplayerid as vplayerid, -- 手机端登录用户id\n        '手机端' as user_type\n    from  dws_jordass_device_login_di f1\n    where  f1.device_type=0 -- 手机端\n    and f1.dtstatdate >= '20250401' and f1.dtstatdate <= date_add('20250530', 29)\n\n    union all\n\n    select \n        f1.dtstatdate as ds, -- 统计日期\n        f1.vplayerid as vplayerid, -- 手机端登录用户id\n        '模拟器' as user_type\n    from  dws_jordass_device_login_di f1\n    where  f1.device_type in (1,5) -- 模拟器\n    and f1.dtstatdate >= '20250401' and f1.dtstatdate <= date_add('20250530', 29)\n\n    union all\n\n    select \n        f1.dtstatdate as ds,  -- 日期\n        f1.vplayerid as vplayerid,  -- 整体游戏内登录用户id\n        '游戏内' as user_type\n    from   dws_jordass_login_di f1  \n    where  f1.dtstatdate >= '20250401' and f1.dtstatdate <= date_add('20250530', 29)\n    and f1.platid = 255  -- 不区分系统平台\n) s2 \n    on   s1.vplayerid = s2.vplayerid\n    group by   s1.ds, user_type\n;",
    "question": "统计注册日期在2025.4.1-2025.5.30的模拟器新进用户在用户类型（模拟器、手机端、整体砺刃游戏内），次留、三留、七留、14留、30留情况\n输出:日期(20250401、...、20250530)、人数、用户类型（模拟器、手机端、游戏内、未知）、次留人数、三留人数、七留人数、14留人数、30留人数",
    "query_toks": [
      "select",
      "s1",
      ".ds",
      "as",
      "`",
      "ds",
      "`",
      ",",
      "-",
      "-",
      "日期",
      "count",
      "(",
      "distinct",
      "s1",
      ".vplayerid",
      ")",
      "as",
      "`",
      "user_cnt",
      "`",
      ",",
      "-",
      "-",
      "人数",
      "coalesce",
      "(",
      "user_type",
      ",",
      "'未知'",
      ")",
      "as",
      "`",
      "user_type",
      "`",
      ",",
      "-",
      "-",
      "用户类型",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "s2",
      ".ds",
      "=",
      "date_add",
      "(",
      "s1",
      ".ds",
      ",",
      "1",
      ")",
      "then",
      "s1",
      ".vplayerid",
      "else",
      "null",
      "end",
      ")",
      "as",
      "`",
      "next_day_retention",
      "`",
      ",",
      "-",
      "-",
      "次留人数",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "s2",
      ".ds",
      "=",
      "date_add",
      "(",
      "s1",
      ".ds",
      ",",
      "2",
      ")",
      "then",
      "s1",
      ".vplayerid",
      "else",
      "null",
      "end",
      ")",
      "as",
      "`",
      "three_day_retention",
      "`",
      ",",
      "-",
      "-",
      "三留人数",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "s2",
      ".ds",
      "=",
      "date_add",
      "(",
      "s1",
      ".ds",
      ",",
      "6",
      ")",
      "then",
      "s1",
      ".vplayerid",
      "else",
      "null",
      "end",
      ")",
      "as",
      "`",
      "seven_day_retention",
      "`",
      ",",
      "-",
      "-",
      "七留人数",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "s2",
      ".ds",
      "=",
      "date_add",
      "(",
      "s1",
      ".ds",
      ",",
      "13",
      ")",
      "then",
      "s1",
      ".vplayerid",
      "else",
      "null",
      "end",
      ")",
      "as",
      "`",
      "fourteen_day_retention",
      "`",
      ",",
      "-",
      "-",
      "14留人数",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "s2",
      ".ds",
      "=",
      "date_add",
      "(",
      "s1",
      ".ds",
      ",",
      "29",
      ")",
      "then",
      "s1",
      ".vplayerid",
      "else",
      "null",
      "end",
      ")",
      "as",
      "`",
      "thirty_day_retention",
      "`",
      "-",
      "-",
      "30留人数",
      "from",
      "(",
      "select",
      "f1",
      ".dregdate",
      "as",
      "ds",
      ",",
      "-",
      "-",
      "日期",
      "f1",
      ".vplayerid",
      "as",
      "vplayerid",
      "-",
      "-",
      "用户id",
      "from",
      "dws_jordass_emulator_df",
      "f1",
      "where",
      "f1",
      ".dtstatdate",
      "=",
      "'20251001'",
      "and",
      "f1",
      ".dregdate",
      ">=",
      "'20250401'",
      "and",
      "f1",
      ".dregdate",
      "<=",
      "'20250530'",
      "and",
      "f1",
      ".platid",
      "=",
      "255",
      ")",
      "s1",
      "left",
      "join",
      "(",
      "select",
      "f1",
      ".dtstatdate",
      "as",
      "ds",
      ",",
      "-",
      "-",
      "统计日期",
      "f1",
      ".vplayerid",
      "as",
      "vplayerid",
      ",",
      "-",
      "-",
      "手机端登录用户id",
      "'手机端'",
      "as",
      "user_type",
      "from",
      "dws_jordass_device_login_di",
      "f1",
      "where",
      "f1",
      ".device_type",
      "=",
      "0",
      "-",
      "-",
      "手机端",
      "and",
      "f1",
      ".dtstatdate",
      ">=",
      "'20250401'",
      "and",
      "f1",
      ".dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20250530'",
      ",",
      "29",
      ")",
      "union",
      "all",
      "select",
      "f1",
      ".dtstatdate",
      "as",
      "ds",
      ",",
      "-",
      "-",
      "统计日期",
      "f1",
      ".vplayerid",
      "as",
      "vplayerid",
      ",",
      "-",
      "-",
      "手机端登录用户id",
      "'模拟器'",
      "as",
      "user_type",
      "from",
      "dws_jordass_device_login_di",
      "f1",
      "where",
      "f1",
      ".device_type",
      "in",
      "(",
      "1",
      ",",
      "5",
      ")",
      "-",
      "-",
      "模拟器",
      "and",
      "f1",
      ".dtstatdate",
      ">=",
      "'20250401'",
      "and",
      "f1",
      ".dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20250530'",
      ",",
      "29",
      ")",
      "union",
      "all",
      "select",
      "f1",
      ".dtstatdate",
      "as",
      "ds",
      ",",
      "-",
      "-",
      "日期",
      "f1",
      ".vplayerid",
      "as",
      "vplayerid",
      ",",
      "-",
      "-",
      "整体游戏内登录用户id",
      "'游戏内'",
      "as",
      "user_type",
      "from",
      "dws_jordass_login_di",
      "f1",
      "where",
      "f1",
      ".dtstatdate",
      ">=",
      "'20250401'",
      "and",
      "f1",
      ".dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20250530'",
      ",",
      "29",
      ")",
      "and",
      "f1",
      ".platid",
      "=",
      "255",
      "-",
      "-",
      "不区分系统平台",
      ")",
      "s2",
      "on",
      "s1",
      ".vplayerid",
      "=",
      "s2",
      ".vplayerid",
      "group",
      "by",
      "s1",
      ".ds",
      ",",
      "user_type",
      ";"
    ],
    "query_toks_no_value": [
      "select",
      "s1",
      ".ds",
      "as",
      "`",
      "ds",
      "`",
      ",",
      "-",
      "-",
      "日期",
      "count",
      "(",
      "distinct",
      "s1",
      ".vplayerid",
      ")",
      "as",
      "`",
      "user_cnt",
      "`",
      ",",
      "-",
      "-",
      "人数",
      "coalesce",
      "(",
      "user_type",
      ",",
      "value",
      ")",
      "as",
      "`",
      "user_type",
      "`",
      ",",
      "-",
      "-",
      "用户类型",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "s2",
      ".ds",
      "=",
      "date_add",
      "(",
      "s1",
      ".ds",
      ",",
      "value",
      ")",
      "then",
      "s1",
      ".vplayerid",
      "else",
      "null",
      "end",
      ")",
      "as",
      "`",
      "next_day_retention",
      "`",
      ",",
      "-",
      "-",
      "次留人数",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "s2",
      ".ds",
      "=",
      "date_add",
      "(",
      "s1",
      ".ds",
      ",",
      "value",
      ")",
      "then",
      "s1",
      ".vplayerid",
      "else",
      "null",
      "end",
      ")",
      "as",
      "`",
      "three_day_retention",
      "`",
      ",",
      "-",
      "-",
      "三留人数",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "s2",
      ".ds",
      "=",
      "date_add",
      "(",
      "s1",
      ".ds",
      ",",
      "value",
      ")",
      "then",
      "s1",
      ".vplayerid",
      "else",
      "null",
      "end",
      ")",
      "as",
      "`",
      "seven_day_retention",
      "`",
      ",",
      "-",
      "-",
      "七留人数",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "s2",
      ".ds",
      "=",
      "date_add",
      "(",
      "s1",
      ".ds",
      ",",
      "value",
      ")",
      "then",
      "s1",
      ".vplayerid",
      "else",
      "null",
      "end",
      ")",
      "as",
      "`",
      "fourteen_day_retention",
      "`",
      ",",
      "-",
      "-",
      "14留人数",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "s2",
      ".ds",
      "=",
      "date_add",
      "(",
      "s1",
      ".ds",
      ",",
      "value",
      ")",
      "then",
      "s1",
      ".vplayerid",
      "else",
      "null",
      "end",
      ")",
      "as",
      "`",
      "thirty_day_retention",
      "`",
      "-",
      "-",
      "30留人数",
      "from",
      "(",
      "select",
      "f1",
      ".dregdate",
      "as",
      "ds",
      ",",
      "-",
      "-",
      "日期",
      "f1",
      ".vplayerid",
      "as",
      "vplayerid",
      "-",
      "-",
      "用户id",
      "from",
      "dws_jordass_emulator_df",
      "f1",
      "where",
      "f1",
      ".dtstatdate",
      "=",
      "value",
      "and",
      "f1",
      ".dregdate",
      ">=",
      "value",
      "and",
      "f1",
      ".dregdate",
      "<=",
      "value",
      "and",
      "f1",
      ".platid",
      "=",
      "value",
      ")",
      "s1",
      "left",
      "join",
      "(",
      "select",
      "f1",
      ".dtstatdate",
      "as",
      "ds",
      ",",
      "-",
      "-",
      "统计日期",
      "f1",
      ".vplayerid",
      "as",
      "vplayerid",
      ",",
      "-",
      "-",
      "手机端登录用户id",
      "value",
      "as",
      "user_type",
      "from",
      "dws_jordass_device_login_di",
      "f1",
      "where",
      "f1",
      ".device_type",
      "=",
      "value",
      "-",
      "-",
      "手机端",
      "and",
      "f1",
      ".dtstatdate",
      ">=",
      "value",
      "and",
      "f1",
      ".dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "union",
      "all",
      "select",
      "f1",
      ".dtstatdate",
      "as",
      "ds",
      ",",
      "-",
      "-",
      "统计日期",
      "f1",
      ".vplayerid",
      "as",
      "vplayerid",
      ",",
      "-",
      "-",
      "手机端登录用户id",
      "value",
      "as",
      "user_type",
      "from",
      "dws_jordass_device_login_di",
      "f1",
      "where",
      "f1",
      ".device_type",
      "in",
      "(",
      "value",
      ",",
      "value",
      ")",
      "-",
      "-",
      "模拟器",
      "and",
      "f1",
      ".dtstatdate",
      ">=",
      "value",
      "and",
      "f1",
      ".dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "union",
      "all",
      "select",
      "f1",
      ".dtstatdate",
      "as",
      "ds",
      ",",
      "-",
      "-",
      "日期",
      "f1",
      ".vplayerid",
      "as",
      "vplayerid",
      ",",
      "-",
      "-",
      "整体游戏内登录用户id",
      "value",
      "as",
      "user_type",
      "from",
      "dws_jordass_login_di",
      "f1",
      "where",
      "f1",
      ".dtstatdate",
      ">=",
      "value",
      "and",
      "f1",
      ".dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "f1",
      ".platid",
      "=",
      "value",
      "-",
      "-",
      "不区分系统平台",
      ")",
      "s2",
      "on",
      "s1",
      ".vplayerid",
      "=",
      "s2",
      ".vplayerid",
      "group",
      "by",
      "s1",
      ".ds",
      ",",
      "user_type",
      ";"
    ],
    "question_toks": [
      "统计",
      "注册",
      "日期",
      "在",
      "2025.4",
      ".",
      "1",
      "-",
      "2025.5",
      ".",
      "30",
      "的",
      "模拟器",
      "新进",
      "用户",
      "在",
      "用户",
      "类型",
      "（",
      "模拟器",
      "、",
      "手机",
      "端",
      "、",
      "整体",
      "砺",
      "刃",
      "游戏",
      "内",
      "）",
      "，",
      "次留",
      "、",
      "三留",
      "、",
      "七留",
      "、",
      "14",
      "留",
      "、",
      "30",
      "留",
      "情况",
      "\n",
      "输出",
      ":",
      "日期",
      "(",
      "20250401",
      "、",
      "...",
      "、",
      "20250530",
      ")",
      "、",
      "人数",
      "、",
      "用户",
      "类型",
      "（",
      "模拟器",
      "、",
      "手机",
      "端",
      "、",
      "游戏",
      "内",
      "、",
      "未知",
      "）",
      "、",
      "次留",
      "人数",
      "、",
      "三留",
      "人数",
      "、",
      "七留",
      "人数",
      "、",
      "14",
      "留",
      "人数",
      "、",
      "30",
      "留",
      "人数"
    ],
    "sql": {
      "select": [
        false,
        [
          [
            "none",
            [
              "s1",
              "ds"
            ]
          ],
          [
            "count",
            [
              "distinct s1",
              "vplayerid"
            ]
          ],
          [
            "none",
            [
              "coalesce",
              "user_type, '未知'"
            ]
          ],
          [
            "count",
            [
              "distinct case when s2",
              "ds = date_add(s1.ds, 1"
            ]
          ],
          [
            "count",
            [
              "distinct case when s2",
              "ds = date_add(s1.ds, 2"
            ]
          ],
          [
            "count",
            [
              "distinct case when s2",
              "ds = date_add(s1.ds, 6"
            ]
          ],
          [
            "count",
            [
              "distinct case when s2",
              "ds = date_add(s1.ds, 13"
            ]
          ],
          [
            "count",
            [
              "distinct case when s2",
              "ds = date_add(s1.ds, 29"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "("
          ]
        ],
        "conds": []
      },
      "where": [
        [
          false,
          "=",
          [
            "none",
            [
              "f1",
              "dtstatdate"
            ],
            null
          ],
          [
            "string",
            "20251001"
          ],
          null
        ],
        "and",
        [
          false,
          ">=",
          [
            "none",
            [
              "f1",
              "dregdate"
            ],
            null
          ],
          [
            "string",
            "20250401"
          ],
          null
        ],
        "and",
        [
          false,
          "<=",
          [
            "none",
            [
              "f1",
              "dregdate"
            ],
            null
          ],
          [
            "string",
            "20250530"
          ],
          null
        ],
        "and",
        [
          false,
          "=",
          [
            "none",
            [
              "f1",
              "platid"
            ],
            null
          ],
          [
            "column",
            [
              null,
              "255 ) s1 left join ("
            ]
          ],
          null
        ]
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": {
        "select": null,
        "from": null,
        "where": null,
        "groupBy": null,
        "orderBy": null,
        "having": null,
        "limit": null,
        "union": null,
        "intersect": null,
        "except": null
      },
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  },
  {
    "query": "with usertype as (\n    select '广域战场' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240723',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '消灭战' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20230804',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '幻想混战' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20241115',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '荒野传说' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240903',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '策略载具' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20241010',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '炎夏混战' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240625',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '单人装备' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240517',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n    union all\n    select '交叉堡垒' itype, dtstatdate, dregdate, vplayerid, cbitmap \n    from dws_jordass_login_df\n    where dtstatdate = date_add('20240412',2) and platid =255 and instr(substr(cbitmap,1,3),'1')>0\n),\ndapan as (\n    select '广域战场' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate >= cast(date_format(date_sub('20240723',7), '%Y%m%d') as bigint) and dtstatdate <= cast(date_format(date_sub('20240723',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '消灭战' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate >= cast(date_format(date_sub('20230804',7), '%Y%m%d') as bigint) and dtstatdate <= cast(date_format(date_sub('20230804',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '幻想混战' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20241115',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20241115',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '荒野传说' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20240903',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20240903',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '策略载具' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20241010',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20241010',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '炎夏混战' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20240625',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20240625',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '单人装备' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20240517',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20240517',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n    union all\n    select '交叉堡垒' itype, suserid, max(case when sgamecode='jordass' then 1 else 0 end) flag1\n    from dws_mgamejp_login_user_activity_di\n    where dtstatdate between cast(date_format(date_sub('20240412',7), '%Y%m%d') as bigint) and cast(date_format(date_sub('20240412',1), '%Y%m%d') as bigint)\n        and saccounttype ='-100'\n        and sgamecode <>'-100'\n        and splattype = '-100'\n        and splat = '-100'\n    group by suserid\n),\ndapan2jordass as (\n    select distinct itype, b.vplayerid, flag1\n    from dapan a\n    join (\n        select vplayerid,suserid from dim_jordass_playerid2suserid_nf\n    ) b on a.suserid = b.suserid\n),\nplayuser as (\n    select '广域战场' itype, min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240723' and dtstatdate <= date_add('20240723',2) and submodename= '广域战场模式'\n    group by vplayerid\n    union all\n    select '消灭战' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20230804' and dtstatdate <= date_add('20230804',2) and modename='组队竞技' and submodename like '%消灭战模式%'\n    group by vplayerid\n    union all\n    select '幻想混战' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20241115' and dtstatdate <= date_add('20241115',2) and modename='创意创作间' and submodename='幻想混战'\n    group by vplayerid\n    union all\n    select '荒野传说' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240903' and dtstatdate <= date_add('20240903',2) and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n    group by vplayerid\n    union all\n    select '策略载具' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20241010' and dtstatdate <= date_add('20241010',2) and modename='休闲模式' and submodename like '%策略载具%'\n    group by vplayerid\n    union all\n    select '炎夏混战' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240625' and dtstatdate <= date_add('20240625',2) and modename='创意创作间' and submodename like '%炎夏混战%'\n    group by vplayerid\n    union all\n    select '单人装备' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240517' and dtstatdate <= date_add('20240517',2) and modename='组队竞技' and submodename like '%单人装备%'\n    group by vplayerid\n    union all\n    select '交叉堡垒' itype,min(dtstatdate) dtstatdate, vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= '20240412' and dtstatdate <= date_add('20240412',2) and modename='组队竞技' and submodename like '%交叉堡垒%'\n    group by vplayerid\n)\n\nselect \n    t.itype,\n    t.user_type,\n    t.iusernum1,\n    p.iusernum2\nfrom (\n    select \n        a.itype,\n        b.user_type,\n        count(distinct a.vplayerid) iusernum1\n    from playuser a\n    join (\n        select \n            itype, vplayerid,\n            case \n                when datediff(dtstatdate,dregdate)<=2 then '砺刃新增'\n                when instr(substr(cbitmap,4),'1')=0 or instr(substr(cbitmap,4),'1')>=60 then '砺刃回流（流失60天以上）'\n                when instr(substr(cbitmap,4),'1')>=21 then '砺刃回流（流失21-59天）'\n                when instr(substr(cbitmap,4),'1')>=14 then '砺刃回流（流失14-20天）'\n                when instr(substr(cbitmap,4),'1')>7 then '砺刃回流（流失7-13天）'\n                when instr(substr(cbitmap,4),'1')<=7 then '砺刃留存' \n            end user_type\n        from usertype\n    ) b on a.itype = b.itype and a.vplayerid = b.vplayerid\n    group by a.itype,b.user_type\n\n    union all\n    \n    select \n        a.itype, \n        case \n            when flag1=0 then '平台盘内' \n            when b.vplayerid is null then '平台盘外' \n        end user_type, \n    count(distinct a.vplayerid) iusernum1\n    from playuser a\n    left join dapan2jordass b \n    on a.itype = b.itype and a.vplayerid = b.vplayerid\n    where flag1=0 or b.vplayerid is null\n    group by a.itype, case when flag1=0 then '平台盘内' when b.vplayerid is null then '平台盘外' end\n) t\nleft join (\n    select itype,\n        case \n            when datediff(dtstatdate,dregdate)<=2 then '砺刃新增'\n            when instr(substr(cbitmap,4),'1')=0 or instr(substr(cbitmap,4),'1')>=60 then '砺刃回流（流失60天以上）'\n            when instr(substr(cbitmap,4),'1')>=21 then '砺刃回流（流失21-59天）'\n            when instr(substr(cbitmap,4),'1')>=14 then '砺刃回流（流失14-20天）'\n            when instr(substr(cbitmap,4),'1')>7 then '砺刃回流（流失7-13天）'\n            when instr(substr(cbitmap,4),'1')<=7 then '砺刃留存' \n        end user_type,\n        count(distinct vplayerid) iusernum2\n    from usertype\n    group by itype,\n        case \n            when datediff(dtstatdate,dregdate)<=2 then '砺刃新增'\n            when instr(substr(cbitmap,4),'1')=0 or instr(substr(cbitmap,4),'1')>=60 then '砺刃回流（流失60天以上）'\n            when instr(substr(cbitmap,4),'1')>=21 then '砺刃回流（流失21-59天）'\n            when instr(substr(cbitmap,4),'1')>=14 then '砺刃回流（流失14-20天）'\n            when instr(substr(cbitmap,4),'1')>7 then '砺刃回流（流失7-13天）'\n            when instr(substr(cbitmap,4),'1')<=7 then '砺刃留存' \n        end\n\n    union all\n\n    select itype,'平台盘内',count(distinct vplayerid) \n    from dapan2jordass \n    group by itype\n) p on t.itype=p.itype and t.user_type=p.user_type\n;",
    "question": "统计不同玩法不同用户类型的参与情况\n\n输出：玩法、用户类型（砺刃新增、砺刃回流（流失60天以上）、砺刃回流（流失21-59天）、砺刃回流（流失14-20天）、砺刃回流（流失7-13天）、砺刃留存、平台盘内、平台盘外）、上线后3天参与用户数、上线后3天总用户数\n\n各玩法上线日期：\n\"广域战场\": \"20240723\",\n\"消灭战\": \"20230804\",\n\"幻想混战\": \"20241115\",\n\"荒野传说\": \"20240903\",\n\"策略载具\": \"20241010\",\n\"炎夏混战\": \"20240625\",\n\"单人装备\": \"20240517\",\n\"交叉堡垒\": \"20240412\"",
    "query_toks": [
      "with",
      "usertype",
      "as",
      "(",
      "select",
      "'广域战场'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "'20240723'",
      ",",
      "2",
      ")",
      "and",
      "platid",
      "=",
      "255",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "1",
      ",",
      "3",
      ")",
      ",",
      "'1'",
      ")",
      ">",
      "0",
      "union",
      "all",
      "select",
      "'消灭战'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "'20230804'",
      ",",
      "2",
      ")",
      "and",
      "platid",
      "=",
      "255",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "1",
      ",",
      "3",
      ")",
      ",",
      "'1'",
      ")",
      ">",
      "0",
      "union",
      "all",
      "select",
      "'幻想混战'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "'20241115'",
      ",",
      "2",
      ")",
      "and",
      "platid",
      "=",
      "255",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "1",
      ",",
      "3",
      ")",
      ",",
      "'1'",
      ")",
      ">",
      "0",
      "union",
      "all",
      "select",
      "'荒野传说'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "'20240903'",
      ",",
      "2",
      ")",
      "and",
      "platid",
      "=",
      "255",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "1",
      ",",
      "3",
      ")",
      ",",
      "'1'",
      ")",
      ">",
      "0",
      "union",
      "all",
      "select",
      "'策略载具'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "'20241010'",
      ",",
      "2",
      ")",
      "and",
      "platid",
      "=",
      "255",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "1",
      ",",
      "3",
      ")",
      ",",
      "'1'",
      ")",
      ">",
      "0",
      "union",
      "all",
      "select",
      "'炎夏混战'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "'20240625'",
      ",",
      "2",
      ")",
      "and",
      "platid",
      "=",
      "255",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "1",
      ",",
      "3",
      ")",
      ",",
      "'1'",
      ")",
      ">",
      "0",
      "union",
      "all",
      "select",
      "'单人装备'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "'20240517'",
      ",",
      "2",
      ")",
      "and",
      "platid",
      "=",
      "255",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "1",
      ",",
      "3",
      ")",
      ",",
      "'1'",
      ")",
      ">",
      "0",
      "union",
      "all",
      "select",
      "'交叉堡垒'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "'20240412'",
      ",",
      "2",
      ")",
      "and",
      "platid",
      "=",
      "255",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "1",
      ",",
      "3",
      ")",
      ",",
      "'1'",
      ")",
      ">",
      "0",
      ")",
      ",",
      "dapan",
      "as",
      "(",
      "select",
      "'广域战场'",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "'jordass'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      ">=",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20240723'",
      ",",
      "7",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20240723'",
      ",",
      "1",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "'-100'",
      "and",
      "sgamecode",
      "<>",
      "'-100'",
      "and",
      "splattype",
      "=",
      "'-100'",
      "and",
      "splat",
      "=",
      "'-100'",
      "group",
      "by",
      "suserid",
      "union",
      "all",
      "select",
      "'消灭战'",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "'jordass'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      ">=",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20230804'",
      ",",
      "7",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20230804'",
      ",",
      "1",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "'-100'",
      "and",
      "sgamecode",
      "<>",
      "'-100'",
      "and",
      "splattype",
      "=",
      "'-100'",
      "and",
      "splat",
      "=",
      "'-100'",
      "group",
      "by",
      "suserid",
      "union",
      "all",
      "select",
      "'幻想混战'",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "'jordass'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      "between",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20241115'",
      ",",
      "7",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20241115'",
      ",",
      "1",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "'-100'",
      "and",
      "sgamecode",
      "<>",
      "'-100'",
      "and",
      "splattype",
      "=",
      "'-100'",
      "and",
      "splat",
      "=",
      "'-100'",
      "group",
      "by",
      "suserid",
      "union",
      "all",
      "select",
      "'荒野传说'",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "'jordass'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      "between",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20240903'",
      ",",
      "7",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20240903'",
      ",",
      "1",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "'-100'",
      "and",
      "sgamecode",
      "<>",
      "'-100'",
      "and",
      "splattype",
      "=",
      "'-100'",
      "and",
      "splat",
      "=",
      "'-100'",
      "group",
      "by",
      "suserid",
      "union",
      "all",
      "select",
      "'策略载具'",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "'jordass'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      "between",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20241010'",
      ",",
      "7",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20241010'",
      ",",
      "1",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "'-100'",
      "and",
      "sgamecode",
      "<>",
      "'-100'",
      "and",
      "splattype",
      "=",
      "'-100'",
      "and",
      "splat",
      "=",
      "'-100'",
      "group",
      "by",
      "suserid",
      "union",
      "all",
      "select",
      "'炎夏混战'",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "'jordass'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      "between",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20240625'",
      ",",
      "7",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20240625'",
      ",",
      "1",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "'-100'",
      "and",
      "sgamecode",
      "<>",
      "'-100'",
      "and",
      "splattype",
      "=",
      "'-100'",
      "and",
      "splat",
      "=",
      "'-100'",
      "group",
      "by",
      "suserid",
      "union",
      "all",
      "select",
      "'单人装备'",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "'jordass'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      "between",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20240517'",
      ",",
      "7",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20240517'",
      ",",
      "1",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "'-100'",
      "and",
      "sgamecode",
      "<>",
      "'-100'",
      "and",
      "splattype",
      "=",
      "'-100'",
      "and",
      "splat",
      "=",
      "'-100'",
      "group",
      "by",
      "suserid",
      "union",
      "all",
      "select",
      "'交叉堡垒'",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "'jordass'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      "between",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20240412'",
      ",",
      "7",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "'20240412'",
      ",",
      "1",
      ")",
      ",",
      "'%Y%m%d'",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "'-100'",
      "and",
      "sgamecode",
      "<>",
      "'-100'",
      "and",
      "splattype",
      "=",
      "'-100'",
      "and",
      "splat",
      "=",
      "'-100'",
      "group",
      "by",
      "suserid",
      ")",
      ",",
      "dapan2jordass",
      "as",
      "(",
      "select",
      "distinct",
      "itype",
      ",",
      "b",
      ".vplayerid",
      ",",
      "flag1",
      "from",
      "dapan",
      "a",
      "join",
      "(",
      "select",
      "vplayerid",
      ",",
      "suserid",
      "from",
      "dim_jordass_playerid2suserid_nf",
      ")",
      "b",
      "on",
      "a",
      ".suserid",
      "=",
      "b",
      ".suserid",
      ")",
      ",",
      "playuser",
      "as",
      "(",
      "select",
      "'广域战场'",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240723'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240723'",
      ",",
      "2",
      ")",
      "and",
      "submodename",
      "=",
      "'广域战场模式'",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "'消灭战'",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20230804'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20230804'",
      ",",
      "2",
      ")",
      "and",
      "modename",
      "=",
      "'组队竞技'",
      "and",
      "submodename",
      "like",
      "'%消灭战模式%'",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "'幻想混战'",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20241115'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20241115'",
      ",",
      "2",
      ")",
      "and",
      "modename",
      "=",
      "'创意创作间'",
      "and",
      "submodename",
      "=",
      "'幻想混战'",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "'荒野传说'",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240903'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240903'",
      ",",
      "2",
      ")",
      "and",
      "modename",
      "=",
      "'休闲模式'",
      "and",
      "submodename",
      "in",
      "(",
      "'荒野传说'",
      ",",
      "'荒野沙漠'",
      ")",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "'策略载具'",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20241010'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20241010'",
      ",",
      "2",
      ")",
      "and",
      "modename",
      "=",
      "'休闲模式'",
      "and",
      "submodename",
      "like",
      "'%策略载具%'",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "'炎夏混战'",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240625'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240625'",
      ",",
      "2",
      ")",
      "and",
      "modename",
      "=",
      "'创意创作间'",
      "and",
      "submodename",
      "like",
      "'%炎夏混战%'",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "'单人装备'",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240517'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240517'",
      ",",
      "2",
      ")",
      "and",
      "modename",
      "=",
      "'组队竞技'",
      "and",
      "submodename",
      "like",
      "'%单人装备%'",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "'交叉堡垒'",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240412'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240412'",
      ",",
      "2",
      ")",
      "and",
      "modename",
      "=",
      "'组队竞技'",
      "and",
      "submodename",
      "like",
      "'%交叉堡垒%'",
      "group",
      "by",
      "vplayerid",
      ")",
      "select",
      "t",
      ".itype",
      ",",
      "t",
      ".user_type",
      ",",
      "t",
      ".iusernum1",
      ",",
      "p",
      ".iusernum2",
      "from",
      "(",
      "select",
      "a",
      ".itype",
      ",",
      "b",
      ".user_type",
      ",",
      "count",
      "(",
      "distinct",
      "a",
      ".vplayerid",
      ")",
      "iusernum1",
      "from",
      "playuser",
      "a",
      "join",
      "(",
      "select",
      "itype",
      ",",
      "vplayerid",
      ",",
      "case",
      "when",
      "datediff",
      "(",
      "dtstatdate",
      ",",
      "dregdate",
      ")",
      "<=",
      "2",
      "then",
      "'砺刃新增'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      "=",
      "0",
      "or",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      ">=",
      "60",
      "then",
      "'砺刃回流（流失60天以上）'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      ">=",
      "21",
      "then",
      "'砺刃回流（流失21-59天）'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      ">=",
      "14",
      "then",
      "'砺刃回流（流失14-20天）'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      ">",
      "7",
      "then",
      "'砺刃回流（流失7-13天）'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      "<=",
      "7",
      "then",
      "'砺刃留存'",
      "end",
      "user_type",
      "from",
      "usertype",
      ")",
      "b",
      "on",
      "a",
      ".itype",
      "=",
      "b",
      ".itype",
      "and",
      "a",
      ".vplayerid",
      "=",
      "b",
      ".vplayerid",
      "group",
      "by",
      "a",
      ".itype",
      ",",
      "b",
      ".user_type",
      "union",
      "all",
      "select",
      "a",
      ".itype",
      ",",
      "case",
      "when",
      "flag1",
      "=",
      "0",
      "then",
      "'平台盘内'",
      "when",
      "b",
      ".vplayerid",
      "is",
      "null",
      "then",
      "'平台盘外'",
      "end",
      "user_type",
      ",",
      "count",
      "(",
      "distinct",
      "a",
      ".vplayerid",
      ")",
      "iusernum1",
      "from",
      "playuser",
      "a",
      "left",
      "join",
      "dapan2jordass",
      "b",
      "on",
      "a",
      ".itype",
      "=",
      "b",
      ".itype",
      "and",
      "a",
      ".vplayerid",
      "=",
      "b",
      ".vplayerid",
      "where",
      "flag1",
      "=",
      "0",
      "or",
      "b",
      ".vplayerid",
      "is",
      "null",
      "group",
      "by",
      "a",
      ".itype",
      ",",
      "case",
      "when",
      "flag1",
      "=",
      "0",
      "then",
      "'平台盘内'",
      "when",
      "b",
      ".vplayerid",
      "is",
      "null",
      "then",
      "'平台盘外'",
      "end",
      ")",
      "t",
      "left",
      "join",
      "(",
      "select",
      "itype",
      ",",
      "case",
      "when",
      "datediff",
      "(",
      "dtstatdate",
      ",",
      "dregdate",
      ")",
      "<=",
      "2",
      "then",
      "'砺刃新增'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      "=",
      "0",
      "or",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      ">=",
      "60",
      "then",
      "'砺刃回流（流失60天以上）'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      ">=",
      "21",
      "then",
      "'砺刃回流（流失21-59天）'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      ">=",
      "14",
      "then",
      "'砺刃回流（流失14-20天）'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      ">",
      "7",
      "then",
      "'砺刃回流（流失7-13天）'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      "<=",
      "7",
      "then",
      "'砺刃留存'",
      "end",
      "user_type",
      ",",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      "iusernum2",
      "from",
      "usertype",
      "group",
      "by",
      "itype",
      ",",
      "case",
      "when",
      "datediff",
      "(",
      "dtstatdate",
      ",",
      "dregdate",
      ")",
      "<=",
      "2",
      "then",
      "'砺刃新增'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      "=",
      "0",
      "or",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      ">=",
      "60",
      "then",
      "'砺刃回流（流失60天以上）'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      ">=",
      "21",
      "then",
      "'砺刃回流（流失21-59天）'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      ">=",
      "14",
      "then",
      "'砺刃回流（流失14-20天）'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      ">",
      "7",
      "then",
      "'砺刃回流（流失7-13天）'",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "4",
      ")",
      ",",
      "'1'",
      ")",
      "<=",
      "7",
      "then",
      "'砺刃留存'",
      "end",
      "union",
      "all",
      "select",
      "itype",
      ",",
      "'平台盘内'",
      ",",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      "from",
      "dapan2jordass",
      "group",
      "by",
      "itype",
      ")",
      "p",
      "on",
      "t",
      ".itype",
      "=",
      "p",
      ".itype",
      "and",
      "t",
      ".user_type",
      "=",
      "p",
      ".user_type",
      ";"
    ],
    "query_toks_no_value": [
      "with",
      "usertype",
      "as",
      "(",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "platid",
      "=",
      "value",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">",
      "value",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "platid",
      "=",
      "value",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">",
      "value",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "platid",
      "=",
      "value",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">",
      "value",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "platid",
      "=",
      "value",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">",
      "value",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "platid",
      "=",
      "value",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">",
      "value",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "platid",
      "=",
      "value",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">",
      "value",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "platid",
      "=",
      "value",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">",
      "value",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "dregdate",
      ",",
      "vplayerid",
      ",",
      "cbitmap",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "platid",
      "=",
      "value",
      "and",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">",
      "value",
      ")",
      ",",
      "dapan",
      "as",
      "(",
      "select",
      "value",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      ">=",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "value",
      "and",
      "sgamecode",
      "<>",
      "value",
      "and",
      "splattype",
      "=",
      "value",
      "and",
      "splat",
      "=",
      "value",
      "group",
      "by",
      "suserid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      ">=",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "value",
      "and",
      "sgamecode",
      "<>",
      "value",
      "and",
      "splattype",
      "=",
      "value",
      "and",
      "splat",
      "=",
      "value",
      "group",
      "by",
      "suserid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      "between",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "value",
      "and",
      "sgamecode",
      "<>",
      "value",
      "and",
      "splattype",
      "=",
      "value",
      "and",
      "splat",
      "=",
      "value",
      "group",
      "by",
      "suserid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      "between",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "value",
      "and",
      "sgamecode",
      "<>",
      "value",
      "and",
      "splattype",
      "=",
      "value",
      "and",
      "splat",
      "=",
      "value",
      "group",
      "by",
      "suserid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      "between",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "value",
      "and",
      "sgamecode",
      "<>",
      "value",
      "and",
      "splattype",
      "=",
      "value",
      "and",
      "splat",
      "=",
      "value",
      "group",
      "by",
      "suserid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      "between",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "value",
      "and",
      "sgamecode",
      "<>",
      "value",
      "and",
      "splattype",
      "=",
      "value",
      "and",
      "splat",
      "=",
      "value",
      "group",
      "by",
      "suserid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      "between",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "value",
      "and",
      "sgamecode",
      "<>",
      "value",
      "and",
      "splattype",
      "=",
      "value",
      "and",
      "splat",
      "=",
      "value",
      "group",
      "by",
      "suserid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "suserid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "sgamecode",
      "=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "flag1",
      "from",
      "dws_mgamejp_login_user_activity_di",
      "where",
      "dtstatdate",
      "between",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "cast",
      "(",
      "date_format",
      "(",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "bigint",
      ")",
      "and",
      "saccounttype",
      "=",
      "value",
      "and",
      "sgamecode",
      "<>",
      "value",
      "and",
      "splattype",
      "=",
      "value",
      "and",
      "splat",
      "=",
      "value",
      "group",
      "by",
      "suserid",
      ")",
      ",",
      "dapan2jordass",
      "as",
      "(",
      "select",
      "distinct",
      "itype",
      ",",
      "b",
      ".vplayerid",
      ",",
      "flag1",
      "from",
      "dapan",
      "a",
      "join",
      "(",
      "select",
      "vplayerid",
      ",",
      "suserid",
      "from",
      "dim_jordass_playerid2suserid_nf",
      ")",
      "b",
      "on",
      "a",
      ".suserid",
      "=",
      "b",
      ".suserid",
      ")",
      ",",
      "playuser",
      "as",
      "(",
      "select",
      "value",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "submodename",
      "=",
      "value",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "=",
      "value",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "min",
      "(",
      "dtstatdate",
      ")",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "vplayerid",
      ")",
      "select",
      "t",
      ".itype",
      ",",
      "t",
      ".user_type",
      ",",
      "t",
      ".iusernum1",
      ",",
      "p",
      ".iusernum2",
      "from",
      "(",
      "select",
      "a",
      ".itype",
      ",",
      "b",
      ".user_type",
      ",",
      "count",
      "(",
      "distinct",
      "a",
      ".vplayerid",
      ")",
      "iusernum1",
      "from",
      "playuser",
      "a",
      "join",
      "(",
      "select",
      "itype",
      ",",
      "vplayerid",
      ",",
      "case",
      "when",
      "datediff",
      "(",
      "dtstatdate",
      ",",
      "dregdate",
      ")",
      "<=",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "=",
      "value",
      "or",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">=",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">=",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">=",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "<=",
      "value",
      "then",
      "value",
      "end",
      "user_type",
      "from",
      "usertype",
      ")",
      "b",
      "on",
      "a",
      ".itype",
      "=",
      "b",
      ".itype",
      "and",
      "a",
      ".vplayerid",
      "=",
      "b",
      ".vplayerid",
      "group",
      "by",
      "a",
      ".itype",
      ",",
      "b",
      ".user_type",
      "union",
      "all",
      "select",
      "a",
      ".itype",
      ",",
      "case",
      "when",
      "flag1",
      "=",
      "value",
      "then",
      "value",
      "when",
      "b",
      ".vplayerid",
      "is",
      "null",
      "then",
      "value",
      "end",
      "user_type",
      ",",
      "count",
      "(",
      "distinct",
      "a",
      ".vplayerid",
      ")",
      "iusernum1",
      "from",
      "playuser",
      "a",
      "left",
      "join",
      "dapan2jordass",
      "b",
      "on",
      "a",
      ".itype",
      "=",
      "b",
      ".itype",
      "and",
      "a",
      ".vplayerid",
      "=",
      "b",
      ".vplayerid",
      "where",
      "flag1",
      "=",
      "value",
      "or",
      "b",
      ".vplayerid",
      "is",
      "null",
      "group",
      "by",
      "a",
      ".itype",
      ",",
      "case",
      "when",
      "flag1",
      "=",
      "value",
      "then",
      "value",
      "when",
      "b",
      ".vplayerid",
      "is",
      "null",
      "then",
      "value",
      "end",
      ")",
      "t",
      "left",
      "join",
      "(",
      "select",
      "itype",
      ",",
      "case",
      "when",
      "datediff",
      "(",
      "dtstatdate",
      ",",
      "dregdate",
      ")",
      "<=",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "=",
      "value",
      "or",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">=",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">=",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">=",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "<=",
      "value",
      "then",
      "value",
      "end",
      "user_type",
      ",",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      "iusernum2",
      "from",
      "usertype",
      "group",
      "by",
      "itype",
      ",",
      "case",
      "when",
      "datediff",
      "(",
      "dtstatdate",
      ",",
      "dregdate",
      ")",
      "<=",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "=",
      "value",
      "or",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">=",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">=",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">=",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">",
      "value",
      "then",
      "value",
      "when",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "<=",
      "value",
      "then",
      "value",
      "end",
      "union",
      "all",
      "select",
      "itype",
      ",",
      "value",
      ",",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      "from",
      "dapan2jordass",
      "group",
      "by",
      "itype",
      ")",
      "p",
      "on",
      "t",
      ".itype",
      "=",
      "p",
      ".itype",
      "and",
      "t",
      ".user_type",
      "=",
      "p",
      ".user_type",
      ";"
    ],
    "question_toks": [
      "统计",
      "不同",
      "玩法",
      "不同",
      "用户",
      "类型",
      "的",
      "参与",
      "情况",
      "\n",
      "\n",
      "输出",
      "：",
      "玩法",
      "、",
      "用户",
      "类型",
      "（",
      "砺",
      "刃",
      "新增",
      "、",
      "砺",
      "刃",
      "回流",
      "（",
      "流失",
      "60",
      "天",
      "以上",
      "）",
      "、",
      "砺",
      "刃",
      "回流",
      "（",
      "流失",
      "21",
      "-",
      "59",
      "天",
      "）",
      "、",
      "砺",
      "刃",
      "回流",
      "（",
      "流失",
      "14",
      "-",
      "20",
      "天",
      "）",
      "、",
      "砺",
      "刃",
      "回流",
      "（",
      "流失",
      "7",
      "-",
      "13",
      "天",
      "）",
      "、",
      "砺",
      "刃",
      "留存",
      "、",
      "平台",
      "盘内",
      "、",
      "平台",
      "盘外",
      "）",
      "、",
      "上线",
      "后",
      "3",
      "天",
      "参与",
      "用户数",
      "、",
      "上线",
      "后",
      "3",
      "天",
      "总",
      "用户数",
      "\n",
      "\n",
      "各",
      "玩法",
      "上线",
      "日期",
      "：",
      "\n",
      "\"",
      "广域",
      "战场",
      "\"",
      ":",
      " ",
      "\"",
      "20240723",
      "\"",
      ",",
      "\n",
      "\"",
      "消灭",
      "战",
      "\"",
      ":",
      " ",
      "\"",
      "20230804",
      "\"",
      ",",
      "\n",
      "\"",
      "幻想",
      "混战",
      "\"",
      ":",
      " ",
      "\"",
      "20241115",
      "\"",
      ",",
      "\n",
      "\"",
      "荒野",
      "传说",
      "\"",
      ":",
      " ",
      "\"",
      "20240903",
      "\"",
      ",",
      "\n",
      "\"",
      "策略",
      "载具",
      "\"",
      ":",
      " ",
      "\"",
      "20241010",
      "\"",
      ",",
      "\n",
      "\"",
      "炎夏",
      "混战",
      "\"",
      ":",
      " ",
      "\"",
      "20240625",
      "\"",
      ",",
      "\n",
      "\"",
      "单人",
      "装备",
      "\"",
      ":",
      " ",
      "\"",
      "20240517",
      "\"",
      ",",
      "\n",
      "\"",
      "交叉",
      "堡垒",
      "\"",
      ":",
      " ",
      "\"",
      "20240412",
      "\""
    ],
    "sql": {
      "select": [
        false,
        [
          [
            "none",
            [
              null,
              "'广域战场' itype"
            ]
          ],
          [
            "none",
            [
              null,
              "dtstatdate"
            ]
          ],
          [
            "none",
            [
              null,
              "dregdate"
            ]
          ],
          [
            "none",
            [
              null,
              "vplayerid"
            ]
          ],
          [
            "none",
            [
              null,
              "cbitmap"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "dws_jordass_login_df"
          ]
        ],
        "conds": []
      },
      "where": [
        [
          false,
          "=",
          [
            "none",
            [
              null,
              "dtstatdate"
            ],
            null
          ],
          [
            "function",
            [
              "date_add",
              "'20240723',2"
            ]
          ],
          null
        ],
        "and",
        "platid =255",
        "and",
        "instr(substr(cbitmap,1,3),'1')>0"
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": {
        "select": null,
        "from": null,
        "where": null,
        "groupBy": null,
        "orderBy": null,
        "having": null,
        "limit": null,
        "union": null,
        "intersect": null,
        "except": null
      },
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  },
  {
    "query": "with playuser as (\n    select '广域战场' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate= '20240723'  and  date_add('20240723',2) and submodename= '广域战场模式'\n    group by 1,2,3\n    union all\n    select '消灭战' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20230804'  and  date_add('20230804',2) and modename='组队竞技' and submodename like '%消灭战模式%'\n    group by 1,2,3\n    union all\n    select '幻想混战' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20241115' and  date_add('20241115',2) and modename='创意创作间' and submodename='幻想混战'\n    group by 1,2,3\n    union all\n    select '荒野传说' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240903'  and  date_add('20240903',2) and modename='休闲模式' and submodename in ('荒野传说','荒野沙漠')\n    group by 1,2,3\n    union all\n    select '策略载具' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20241010'   and  date_add('20241010',2) and modename='休闲模式' and submodename like '%策略载具%'\n    group by 1,2,3\n    union all\n    select '炎夏混战' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240625'   and  date_add('20240625',2) and modename='创意创作间' and submodename like '%炎夏混战%'\n    group by 1,2,3\n    union all\n    select '单人装备' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240517'   and  date_add('20240517',2) and modename='组队竞技' and submodename like '%单人装备%'\n    group by 1,2,3\n    union all\n    select '交叉堡垒' itype,dtstatdate,vplayerid\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240412'   and  date_add('20240412',2) and modename='组队竞技' and submodename like '%交叉堡垒%'\n    group by 1,2,3\n    union all\n    select '庆典混战' as itype,dtstatdate,vplayerid\n    from  dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240426'  and  date_add('20240426',2) and submode in (2611)\n    group by dtstatdate,vplayerid\n    union all\n    select 'CG29-流浪地球' as itype,dtstatdate,vplayerid\n    from  dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20240903' and  date_add('20240903',2)and submodename = 'CG29-流浪地球'\n    group by dtstatdate,vplayerid\n    union all\n    select 'CG28-动物丛林' as itype,dtstatdate,vplayerid\n    from  dws_jordass_mode_roundrecord_di\n    where dtstatdate = '20241105' and  date_add('20241105',2)and submodename = 'CG28-动物丛林'\n    group by dtstatdate,vplayerid\n),\nallplayuser as (\n    select '广域战场' itype,\n        case \n            when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n        end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240723' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240723' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240723',7) and dtstatdate <= date_add('20240723',2)  \n    group by \n        case \n            when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n        end ,\n        vplayerid\n    union all\n    select '消灭战' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20230804' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20230804' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20230804',7) and dtstatdate <= date_add('20230804',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '幻想混战' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20241115' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20241115' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20241115',7) and dtstatdate <= date_add('20241115',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '荒野传说' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240903' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240903' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240903',7) and dtstatdate <= date_add('20240903',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '策略载具' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20241010' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20241010' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20241010',7) and dtstatdate <= date_add('20241010',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '炎夏混战' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240625' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240625' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240625',7) and dtstatdate <= date_add('20240625',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '单人装备' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240517' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240517' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240517',7) and dtstatdate <= date_add('20240517',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '交叉堡垒' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240412' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240412' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240412',7) and dtstatdate <= date_add('20240412',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select '庆典混战' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240426' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240426' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240426',7) and dtstatdate <= date_add('20240426',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select 'CG28-动物丛林' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20240903' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20240903' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20240903',7) and dtstatdate <= date_add('20240903',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n    union all\n    select 'CG29-流浪地球' itype,\n        case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end playclass1,\n        vplayerid,\n        max(case when dtstatdate<'20241105' then 1 else 0 end) islast,\n        max(case when dtstatdate>='20241105' then 1 else 0 end) isthis\n    from dws_jordass_mode_roundrecord_di\n    where dtstatdate >= date_sub('20241105',7) and dtstatdate <= date_add('20241105',2)  \n    group by case when modename='传统模式' and submodename like 'CG%' and mapname='群屿' then '主题群屿'\n            when modename='传统模式' and mapname='群屿' then '传统群屿'\n            when modename='传统模式' and mapname='假日群岛' then '假日群岛'\n            when modename='传统模式' and mapname='山峦' then '山峦'\n            when submodename='极能形态模式' then '极能形态模式'\n            when modename='生存模式' then '隧道'\n            when submodename='广域战场模式' then '广域战场'\n            when modename in ('休闲模式','乐园','领地','广阔天地','组队竞技') then modename\n            else '其他子模式'\n            end ,\n        vplayerid\n)\n\nselect  \n    t.itype, \n    t.playclass1, \n    iusernum1, -- 流入玩法参与用户数\n    iusernum2, -- 流出用户数\n    iusernum3, -- 双栖用户数\n    iusernum4, -- 前一周流出玩法用户数\n    coalesce(round(iusernum2/iusernum4, 2), 0) as ratio1, -- 流出占比\n    iusernum5, -- 后3天流出玩法用户数\n    coalesce(round(iusernum3/iusernum5, 2), 0) as ratio2 -- 双栖占比\nfrom (\n    select itype,count(distinct vplayerid) iusernum1 from playuser group by itype\n)p\nleft join (\n    select \n        a.itype,\n        b.playclass1,\n        count(distinct case when islast=1 and isthis =0 then a.vplayerid end) iusernum2,\n        count(distinct case when islast=1 and isthis =1 then a.vplayerid end) iusernum3\n    from playuser a\n    left join allplayuser b \n    on a.itype =b.itype and a.vplayerid = b.vplayerid\n    group by a.itype,b.playclass1\n)t on p.itype = t.itype\nleft join (\n    select \n        itype, \n        playclass1,\n        count(distinct case when islast=1 then vplayerid end) iusernum4,\n        count(distinct case when isthis=1 then vplayerid end) iusernum5\n    from allplayuser\n    group by itype,playclass1\n) m on t.playclass1=m.playclass1 and t.itype=m.itype\n;",
    "question": "\n统计各个玩法参与用户其他玩法流入和双栖情况\n\n输出：流入玩法、流出玩法、上线后3天流入玩法参与用户数、上线后3天流出用户数、上线后3天双栖用户数、上线前一周流出玩法总参与用户数、流出占比、上线后3天流出玩法总参与用户数、双栖占比\n",
    "query_toks": [
      "with",
      "playuser",
      "as",
      "(",
      "select",
      "'广域战场'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "'20240723'",
      "and",
      "date_add",
      "(",
      "'20240723'",
      ",",
      "2",
      ")",
      "and",
      "submodename",
      "=",
      "'广域战场模式'",
      "group",
      "by",
      "1",
      ",",
      "2",
      ",",
      "3",
      "union",
      "all",
      "select",
      "'消灭战'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "'20230804'",
      "and",
      "date_add",
      "(",
      "'20230804'",
      ",",
      "2",
      ")",
      "and",
      "modename",
      "=",
      "'组队竞技'",
      "and",
      "submodename",
      "like",
      "'%消灭战模式%'",
      "group",
      "by",
      "1",
      ",",
      "2",
      ",",
      "3",
      "union",
      "all",
      "select",
      "'幻想混战'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "'20241115'",
      "and",
      "date_add",
      "(",
      "'20241115'",
      ",",
      "2",
      ")",
      "and",
      "modename",
      "=",
      "'创意创作间'",
      "and",
      "submodename",
      "=",
      "'幻想混战'",
      "group",
      "by",
      "1",
      ",",
      "2",
      ",",
      "3",
      "union",
      "all",
      "select",
      "'荒野传说'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "'20240903'",
      "and",
      "date_add",
      "(",
      "'20240903'",
      ",",
      "2",
      ")",
      "and",
      "modename",
      "=",
      "'休闲模式'",
      "and",
      "submodename",
      "in",
      "(",
      "'荒野传说'",
      ",",
      "'荒野沙漠'",
      ")",
      "group",
      "by",
      "1",
      ",",
      "2",
      ",",
      "3",
      "union",
      "all",
      "select",
      "'策略载具'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "'20241010'",
      "and",
      "date_add",
      "(",
      "'20241010'",
      ",",
      "2",
      ")",
      "and",
      "modename",
      "=",
      "'休闲模式'",
      "and",
      "submodename",
      "like",
      "'%策略载具%'",
      "group",
      "by",
      "1",
      ",",
      "2",
      ",",
      "3",
      "union",
      "all",
      "select",
      "'炎夏混战'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "'20240625'",
      "and",
      "date_add",
      "(",
      "'20240625'",
      ",",
      "2",
      ")",
      "and",
      "modename",
      "=",
      "'创意创作间'",
      "and",
      "submodename",
      "like",
      "'%炎夏混战%'",
      "group",
      "by",
      "1",
      ",",
      "2",
      ",",
      "3",
      "union",
      "all",
      "select",
      "'单人装备'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "'20240517'",
      "and",
      "date_add",
      "(",
      "'20240517'",
      ",",
      "2",
      ")",
      "and",
      "modename",
      "=",
      "'组队竞技'",
      "and",
      "submodename",
      "like",
      "'%单人装备%'",
      "group",
      "by",
      "1",
      ",",
      "2",
      ",",
      "3",
      "union",
      "all",
      "select",
      "'交叉堡垒'",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "'20240412'",
      "and",
      "date_add",
      "(",
      "'20240412'",
      ",",
      "2",
      ")",
      "and",
      "modename",
      "=",
      "'组队竞技'",
      "and",
      "submodename",
      "like",
      "'%交叉堡垒%'",
      "group",
      "by",
      "1",
      ",",
      "2",
      ",",
      "3",
      "union",
      "all",
      "select",
      "'庆典混战'",
      "as",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "'20240426'",
      "and",
      "date_add",
      "(",
      "'20240426'",
      ",",
      "2",
      ")",
      "and",
      "submode",
      "in",
      "(",
      "2611",
      ")",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'CG29-流浪地球'",
      "as",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "'20240903'",
      "and",
      "date_add",
      "(",
      "'20240903'",
      ",",
      "2",
      ")",
      "and",
      "submodename",
      "=",
      "'CG29-流浪地球'",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'CG28-动物丛林'",
      "as",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "'20241105'",
      "and",
      "date_add",
      "(",
      "'20241105'",
      ",",
      "2",
      ")",
      "and",
      "submodename",
      "=",
      "'CG28-动物丛林'",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      ")",
      ",",
      "allplayuser",
      "as",
      "(",
      "select",
      "'广域战场'",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "'20240723'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "'20240723'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "'20240723'",
      ",",
      "7",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240723'",
      ",",
      "2",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'消灭战'",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "'20230804'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "'20230804'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "'20230804'",
      ",",
      "7",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20230804'",
      ",",
      "2",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'幻想混战'",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "'20241115'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "'20241115'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "'20241115'",
      ",",
      "7",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20241115'",
      ",",
      "2",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'荒野传说'",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "'20240903'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "'20240903'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "'20240903'",
      ",",
      "7",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240903'",
      ",",
      "2",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'策略载具'",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "'20241010'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "'20241010'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "'20241010'",
      ",",
      "7",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20241010'",
      ",",
      "2",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'炎夏混战'",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "'20240625'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "'20240625'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "'20240625'",
      ",",
      "7",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240625'",
      ",",
      "2",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'单人装备'",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "'20240517'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "'20240517'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "'20240517'",
      ",",
      "7",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240517'",
      ",",
      "2",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'交叉堡垒'",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "'20240412'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "'20240412'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "'20240412'",
      ",",
      "7",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240412'",
      ",",
      "2",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'庆典混战'",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "'20240426'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "'20240426'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "'20240426'",
      ",",
      "7",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240426'",
      ",",
      "2",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'CG28-动物丛林'",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "'20240903'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "'20240903'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "'20240903'",
      ",",
      "7",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240903'",
      ",",
      "2",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "'CG29-流浪地球'",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "'20241105'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "'20241105'",
      "then",
      "1",
      "else",
      "0",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "'20241105'",
      ",",
      "7",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20241105'",
      ",",
      "2",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "submodename",
      "like",
      "'CG%'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'主题群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'群屿'",
      "then",
      "'传统群屿'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'假日群岛'",
      "then",
      "'假日群岛'",
      "when",
      "modename",
      "=",
      "'传统模式'",
      "and",
      "mapname",
      "=",
      "'山峦'",
      "then",
      "'山峦'",
      "when",
      "submodename",
      "=",
      "'极能形态模式'",
      "then",
      "'极能形态模式'",
      "when",
      "modename",
      "=",
      "'生存模式'",
      "then",
      "'隧道'",
      "when",
      "submodename",
      "=",
      "'广域战场模式'",
      "then",
      "'广域战场'",
      "when",
      "modename",
      "in",
      "(",
      "'休闲模式'",
      ",",
      "'乐园'",
      ",",
      "'领地'",
      ",",
      "'广阔天地'",
      ",",
      "'组队竞技'",
      ")",
      "then",
      "modename",
      "else",
      "'其他子模式'",
      "end",
      ",",
      "vplayerid",
      ")",
      "select",
      "t",
      ".itype",
      ",",
      "t",
      ".playclass1",
      ",",
      "iusernum1",
      ",",
      "-",
      "-",
      "流入玩法参与用户数",
      "iusernum2",
      ",",
      "-",
      "-",
      "流出用户数",
      "iusernum3",
      ",",
      "-",
      "-",
      "双栖用户数",
      "iusernum4",
      ",",
      "-",
      "-",
      "前一周流出玩法用户数",
      "coalesce",
      "(",
      "round",
      "(",
      "iusernum2",
      "/",
      "iusernum4",
      ",",
      "2",
      ")",
      ",",
      "0",
      ")",
      "as",
      "ratio1",
      ",",
      "-",
      "-",
      "流出占比",
      "iusernum5",
      ",",
      "-",
      "-",
      "后3天流出玩法用户数",
      "coalesce",
      "(",
      "round",
      "(",
      "iusernum3",
      "/",
      "iusernum5",
      ",",
      "2",
      ")",
      ",",
      "0",
      ")",
      "as",
      "ratio2",
      "-",
      "-",
      "双栖占比",
      "from",
      "(",
      "select",
      "itype",
      ",",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      "iusernum1",
      "from",
      "playuser",
      "group",
      "by",
      "itype",
      ")",
      "p",
      "left",
      "join",
      "(",
      "select",
      "a",
      ".itype",
      ",",
      "b",
      ".playclass1",
      ",",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "islast",
      "=",
      "1",
      "and",
      "isthis",
      "=",
      "0",
      "then",
      "a",
      ".vplayerid",
      "end",
      ")",
      "iusernum2",
      ",",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "islast",
      "=",
      "1",
      "and",
      "isthis",
      "=",
      "1",
      "then",
      "a",
      ".vplayerid",
      "end",
      ")",
      "iusernum3",
      "from",
      "playuser",
      "a",
      "left",
      "join",
      "allplayuser",
      "b",
      "on",
      "a",
      ".itype",
      "=",
      "b",
      ".itype",
      "and",
      "a",
      ".vplayerid",
      "=",
      "b",
      ".vplayerid",
      "group",
      "by",
      "a",
      ".itype",
      ",",
      "b",
      ".playclass1",
      ")",
      "t",
      "on",
      "p",
      ".itype",
      "=",
      "t",
      ".itype",
      "left",
      "join",
      "(",
      "select",
      "itype",
      ",",
      "playclass1",
      ",",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "islast",
      "=",
      "1",
      "then",
      "vplayerid",
      "end",
      ")",
      "iusernum4",
      ",",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "isthis",
      "=",
      "1",
      "then",
      "vplayerid",
      "end",
      ")",
      "iusernum5",
      "from",
      "allplayuser",
      "group",
      "by",
      "itype",
      ",",
      "playclass1",
      ")",
      "m",
      "on",
      "t",
      ".playclass1",
      "=",
      "m",
      ".playclass1",
      "and",
      "t",
      ".itype",
      "=",
      "m",
      ".itype",
      ";"
    ],
    "query_toks_no_value": [
      "with",
      "playuser",
      "as",
      "(",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "value",
      "and",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "submodename",
      "=",
      "value",
      "group",
      "by",
      "value",
      ",",
      "value",
      ",",
      "value",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "value",
      "and",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "value",
      ",",
      "value",
      ",",
      "value",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "value",
      "and",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "=",
      "value",
      "group",
      "by",
      "value",
      ",",
      "value",
      ",",
      "value",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "value",
      "and",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "value",
      ",",
      "value",
      ",",
      "value",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "value",
      "and",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "value",
      ",",
      "value",
      ",",
      "value",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "value",
      "and",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "value",
      ",",
      "value",
      ",",
      "value",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "value",
      "and",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "value",
      ",",
      "value",
      ",",
      "value",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "value",
      "and",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "group",
      "by",
      "value",
      ",",
      "value",
      ",",
      "value",
      "union",
      "all",
      "select",
      "value",
      "as",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "value",
      "and",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "submode",
      "in",
      "(",
      "value",
      ")",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "as",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "value",
      "and",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "submodename",
      "=",
      "value",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "as",
      "itype",
      ",",
      "dtstatdate",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      "=",
      "value",
      "and",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "submodename",
      "=",
      "value",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      ")",
      ",",
      "allplayuser",
      "as",
      "(",
      "select",
      "value",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      ",",
      "vplayerid",
      "union",
      "all",
      "select",
      "value",
      "itype",
      ",",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      "playclass1",
      ",",
      "vplayerid",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      "<",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "islast",
      ",",
      "max",
      "(",
      "case",
      "when",
      "dtstatdate",
      ">=",
      "value",
      "then",
      "value",
      "else",
      "value",
      "end",
      ")",
      "isthis",
      "from",
      "dws_jordass_mode_roundrecord_di",
      "where",
      "dtstatdate",
      ">=",
      "date_sub",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "case",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "submodename",
      "like",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "and",
      "mapname",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "submodename",
      "=",
      "value",
      "then",
      "value",
      "when",
      "modename",
      "in",
      "(",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ",",
      "value",
      ")",
      "then",
      "modename",
      "else",
      "value",
      "end",
      ",",
      "vplayerid",
      ")",
      "select",
      "t",
      ".itype",
      ",",
      "t",
      ".playclass1",
      ",",
      "iusernum1",
      ",",
      "-",
      "-",
      "流入玩法参与用户数",
      "iusernum2",
      ",",
      "-",
      "-",
      "流出用户数",
      "iusernum3",
      ",",
      "-",
      "-",
      "双栖用户数",
      "iusernum4",
      ",",
      "-",
      "-",
      "前一周流出玩法用户数",
      "coalesce",
      "(",
      "round",
      "(",
      "iusernum2",
      "/",
      "iusernum4",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "ratio1",
      ",",
      "-",
      "-",
      "流出占比",
      "iusernum5",
      ",",
      "-",
      "-",
      "后3天流出玩法用户数",
      "coalesce",
      "(",
      "round",
      "(",
      "iusernum3",
      "/",
      "iusernum5",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "as",
      "ratio2",
      "-",
      "-",
      "双栖占比",
      "from",
      "(",
      "select",
      "itype",
      ",",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      "iusernum1",
      "from",
      "playuser",
      "group",
      "by",
      "itype",
      ")",
      "p",
      "left",
      "join",
      "(",
      "select",
      "a",
      ".itype",
      ",",
      "b",
      ".playclass1",
      ",",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "islast",
      "=",
      "value",
      "and",
      "isthis",
      "=",
      "value",
      "then",
      "a",
      ".vplayerid",
      "end",
      ")",
      "iusernum2",
      ",",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "islast",
      "=",
      "value",
      "and",
      "isthis",
      "=",
      "value",
      "then",
      "a",
      ".vplayerid",
      "end",
      ")",
      "iusernum3",
      "from",
      "playuser",
      "a",
      "left",
      "join",
      "allplayuser",
      "b",
      "on",
      "a",
      ".itype",
      "=",
      "b",
      ".itype",
      "and",
      "a",
      ".vplayerid",
      "=",
      "b",
      ".vplayerid",
      "group",
      "by",
      "a",
      ".itype",
      ",",
      "b",
      ".playclass1",
      ")",
      "t",
      "on",
      "p",
      ".itype",
      "=",
      "t",
      ".itype",
      "left",
      "join",
      "(",
      "select",
      "itype",
      ",",
      "playclass1",
      ",",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "islast",
      "=",
      "value",
      "then",
      "vplayerid",
      "end",
      ")",
      "iusernum4",
      ",",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "isthis",
      "=",
      "value",
      "then",
      "vplayerid",
      "end",
      ")",
      "iusernum5",
      "from",
      "allplayuser",
      "group",
      "by",
      "itype",
      ",",
      "playclass1",
      ")",
      "m",
      "on",
      "t",
      ".playclass1",
      "=",
      "m",
      ".playclass1",
      "and",
      "t",
      ".itype",
      "=",
      "m",
      ".itype",
      ";"
    ],
    "question_toks": [
      "\n",
      "统计",
      "各个",
      "玩法",
      "参与",
      "用户",
      "其他",
      "玩法",
      "流入",
      "和",
      "双栖",
      "情况",
      "\n",
      "\n",
      "输出",
      "：",
      "流入",
      "玩法",
      "、",
      "流出",
      "玩法",
      "、",
      "上线",
      "后",
      "3",
      "天",
      "流入",
      "玩法",
      "参与",
      "用户数",
      "、",
      "上线",
      "后",
      "3",
      "天",
      "流出",
      "用户数",
      "、",
      "上线",
      "后",
      "3",
      "天",
      "双栖",
      "用户数",
      "、",
      "上线",
      "前",
      "一周",
      "流出",
      "玩法",
      "总",
      "参与",
      "用户数",
      "、",
      "流出",
      "占",
      "比",
      "、",
      "上线",
      "后",
      "3",
      "天",
      "流出",
      "玩法",
      "总",
      "参与",
      "用户数",
      "、",
      "双栖",
      "占",
      "比",
      "\n"
    ],
    "sql": {
      "select": [
        false,
        [
          [
            "none",
            [
              null,
              "'广域战场' itype"
            ]
          ],
          [
            "none",
            [
              null,
              "dtstatdate"
            ]
          ],
          [
            "none",
            [
              null,
              "vplayerid"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "dws_jordass_mode_roundrecord_di"
          ]
        ],
        "conds": []
      },
      "where": [
        "dtstatdate= '20240723'",
        "and",
        "date_add('20240723',2)",
        "and",
        "submodename= '广域战场模式'"
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": {
        "select": null,
        "from": null,
        "where": null,
        "groupBy": null,
        "orderBy": null,
        "having": null,
        "limit": null,
        "union": null,
        "intersect": null,
        "except": null
      },
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  },
  {
    "query": "select count(distinct a.vplayerid) as player_num\nfrom (\n    select distinct vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20240101' and '20240107'\n    and imode = 1287652322611036928\n) a\nleft join (\n    select distinct vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20240108' and '20240114'\n    and imode = 1287652322611036928\n) b on a.vplayerid = b.vplayerid\njoin (\n    select distinct vplayerid\n    from dws_jordass_matchlog_stat_di\n    where dtstatdate between '20240115' and '20240121'\n    and imode = 1287652322611036928\n) c on a.vplayerid = c.vplayerid\nwhere b.vplayerid is null;",
    "question": "统计2024.01.01-2024.01.07参与乐园子玩法拼图狂欢在202401.08-2024.01.14没玩乐园子玩法拼图狂欢在2024.01.15-2024.01.21又玩了乐园子玩法拼图狂欢的用户\n输出：玩家数",
    "query_toks": [
      "select",
      "count",
      "(",
      "distinct",
      "a",
      ".vplayerid",
      ")",
      "as",
      "player_num",
      "from",
      "(",
      "select",
      "distinct",
      "vplayerid",
      "from",
      "dws_jordass_matchlog_stat_di",
      "where",
      "dtstatdate",
      "between",
      "'20240101'",
      "and",
      "'20240107'",
      "and",
      "imode",
      "=",
      "1287652322611036928",
      ")",
      "a",
      "left",
      "join",
      "(",
      "select",
      "distinct",
      "vplayerid",
      "from",
      "dws_jordass_matchlog_stat_di",
      "where",
      "dtstatdate",
      "between",
      "'20240108'",
      "and",
      "'20240114'",
      "and",
      "imode",
      "=",
      "1287652322611036928",
      ")",
      "b",
      "on",
      "a",
      ".vplayerid",
      "=",
      "b",
      ".vplayerid",
      "join",
      "(",
      "select",
      "distinct",
      "vplayerid",
      "from",
      "dws_jordass_matchlog_stat_di",
      "where",
      "dtstatdate",
      "between",
      "'20240115'",
      "and",
      "'20240121'",
      "and",
      "imode",
      "=",
      "1287652322611036928",
      ")",
      "c",
      "on",
      "a",
      ".vplayerid",
      "=",
      "c",
      ".vplayerid",
      "where",
      "b",
      ".vplayerid",
      "is",
      "null",
      ";"
    ],
    "query_toks_no_value": [
      "select",
      "count",
      "(",
      "distinct",
      "a",
      ".vplayerid",
      ")",
      "as",
      "player_num",
      "from",
      "(",
      "select",
      "distinct",
      "vplayerid",
      "from",
      "dws_jordass_matchlog_stat_di",
      "where",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      "and",
      "imode",
      "=",
      "value",
      ")",
      "a",
      "left",
      "join",
      "(",
      "select",
      "distinct",
      "vplayerid",
      "from",
      "dws_jordass_matchlog_stat_di",
      "where",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      "and",
      "imode",
      "=",
      "value",
      ")",
      "b",
      "on",
      "a",
      ".vplayerid",
      "=",
      "b",
      ".vplayerid",
      "join",
      "(",
      "select",
      "distinct",
      "vplayerid",
      "from",
      "dws_jordass_matchlog_stat_di",
      "where",
      "dtstatdate",
      "between",
      "value",
      "and",
      "value",
      "and",
      "imode",
      "=",
      "value",
      ")",
      "c",
      "on",
      "a",
      ".vplayerid",
      "=",
      "c",
      ".vplayerid",
      "where",
      "b",
      ".vplayerid",
      "is",
      "null",
      ";"
    ],
    "question_toks": [
      "统计",
      "2024.01",
      ".",
      "01",
      "-",
      "2024.01",
      ".",
      "07",
      "参与",
      "乐园",
      "子",
      "玩法",
      "拼图",
      "狂欢",
      "在",
      "202401.08",
      "-",
      "2024.01",
      ".",
      "14",
      "没",
      "玩乐",
      "园子",
      "玩法",
      "拼图",
      "狂欢",
      "在",
      "2024.01",
      ".",
      "15",
      "-",
      "2024.01",
      ".",
      "21",
      "又",
      "玩",
      "了",
      "乐园",
      "子",
      "玩法",
      "拼图",
      "狂欢",
      "的",
      "用户",
      "\n",
      "输出",
      "：",
      "玩家",
      "数"
    ],
    "sql": {
      "select": [
        false,
        [
          [
            "count",
            [
              "distinct a",
              "vplayerid"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "("
          ]
        ],
        "conds": []
      },
      "where": [
        [
          false,
          "between",
          [
            "none",
            [
              null,
              "dtstatdate"
            ],
            null
          ],
          [
            "string",
            "20240101"
          ],
          null
        ],
        "and",
        "'20240107'",
        "and",
        [
          false,
          "=",
          [
            "none",
            [
              null,
              "imode"
            ],
            null
          ],
          [
            "column",
            [
              null,
              "1287652322611036928 ) a left join ("
            ]
          ],
          null
        ]
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": null,
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  },
  {
    "query": "select\n    week, -- 统计周\n    active_days, -- 活跃天数\n    count(distinct vplayerid) as user_num -- 玩家数\nfrom (\n    select\n        vplayerid, -- 玩家playerid\n        weekofyear(dtstatdate) as week, -- 统计周\n        count(distinct dtstatdate) as active_days -- 活跃天数\n    from dws_jordass_login_di\n    where dtstatdate >= '20240101' and dtstatdate <= '20240202' and platid=255\n    group by\n        vplayerid,\n        weekofyear(dtstatdate)\n)f\ngroup by\n    week,\n    active_days",
    "question": "统计2024.1.1-2024.2.2期间，每个自然周不同周活跃天数玩家数\n输出：统计周(1、2、3...、5)、周活跃天数、玩家数",
    "query_toks": [
      "select",
      "week",
      ",",
      "-",
      "-",
      "统计周",
      "active_days",
      ",",
      "-",
      "-",
      "活跃天数",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      "as",
      "user_num",
      "-",
      "-",
      "玩家数",
      "from",
      "(",
      "select",
      "vplayerid",
      ",",
      "-",
      "-",
      "玩家playerid",
      "weekofyear",
      "(",
      "dtstatdate",
      ")",
      "as",
      "week",
      ",",
      "-",
      "-",
      "统计周",
      "count",
      "(",
      "distinct",
      "dtstatdate",
      ")",
      "as",
      "active_days",
      "-",
      "-",
      "活跃天数",
      "from",
      "dws_jordass_login_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240101'",
      "and",
      "dtstatdate",
      "<=",
      "'20240202'",
      "and",
      "platid",
      "=",
      "255",
      "group",
      "by",
      "vplayerid",
      ",",
      "weekofyear",
      "(",
      "dtstatdate",
      ")",
      ")",
      "f",
      "group",
      "by",
      "week",
      ",",
      "active_days"
    ],
    "query_toks_no_value": [
      "select",
      "week",
      ",",
      "-",
      "-",
      "统计周",
      "active_days",
      ",",
      "-",
      "-",
      "活跃天数",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      "as",
      "user_num",
      "-",
      "-",
      "玩家数",
      "from",
      "(",
      "select",
      "vplayerid",
      ",",
      "-",
      "-",
      "玩家playerid",
      "weekofyear",
      "(",
      "dtstatdate",
      ")",
      "as",
      "week",
      ",",
      "-",
      "-",
      "统计周",
      "count",
      "(",
      "distinct",
      "dtstatdate",
      ")",
      "as",
      "active_days",
      "-",
      "-",
      "活跃天数",
      "from",
      "dws_jordass_login_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "value",
      "and",
      "platid",
      "=",
      "value",
      "group",
      "by",
      "vplayerid",
      ",",
      "weekofyear",
      "(",
      "dtstatdate",
      ")",
      ")",
      "f",
      "group",
      "by",
      "week",
      ",",
      "active_days"
    ],
    "question_toks": [
      "统计",
      "2024.1",
      ".",
      "1",
      "-",
      "2024.2",
      ".",
      "2",
      "期间",
      "，",
      "每个",
      "自然",
      "周",
      "不同",
      "周",
      "活跃",
      "天数",
      "玩家",
      "数",
      "\n",
      "输出",
      "：",
      "统计",
      "周",
      "(",
      "1",
      "、",
      "2",
      "、",
      "3",
      "...",
      "、",
      "5",
      ")",
      "、",
      "周",
      "活跃",
      "天数",
      "、",
      "玩家",
      "数"
    ],
    "sql": {
      "select": [
        false,
        [
          [
            "none",
            [
              null,
              "week"
            ]
          ],
          [
            "none",
            [
              null,
              "active_days"
            ]
          ],
          [
            "count",
            [
              null,
              "distinct vplayerid"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "("
          ]
        ],
        "conds": []
      },
      "where": [
        [
          false,
          ">=",
          [
            "none",
            [
              null,
              "dtstatdate"
            ],
            null
          ],
          [
            "string",
            "20240101"
          ],
          null
        ],
        "and",
        [
          false,
          "<=",
          [
            "none",
            [
              null,
              "dtstatdate"
            ],
            null
          ],
          [
            "string",
            "20240202"
          ],
          null
        ],
        "and",
        "platid=255"
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": null,
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  },
  {
    "query": "select\n    count(distinct case when is_backflow_7 then vplayerid end) as backflow_7_user,\n    count(distinct case when is_backflow_30 then vplayerid end) as backflow_30_user\nfrom (\n    select\n        vplayerid,\n        -- 检查是否满足流失7天回流条件\n        (dregdate <> dtstatdate) and\n        (instr(substr(cbitmap, 1, 1), '1') > 0) and\n        (instr(substr(cbitmap, 2, 7), '1') = 0) as is_backflow_7,\n        \n        -- 检查是否满足流失30天回流条件\n        (dregdate <> dtstatdate) and\n        (instr(substr(cbitmap, 1, 1), '1') > 0) and\n        (instr(substr(cbitmap, 2, 30), '1') = 0) as is_backflow_30\n    from\n        dws_jordass_login_df\n    where\n        dtstatdate = '20231201'\n        and platid = 255\n) as user_flags;",
    "question": "统计2023.12.1流失7天的回流用户数和流失30天的回流用户数\n输出：流失7天的回流用户数，流失30天的回流用户数",
    "query_toks": [
      "select",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "is_backflow_7",
      "then",
      "vplayerid",
      "end",
      ")",
      "as",
      "backflow_7_user",
      ",",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "is_backflow_30",
      "then",
      "vplayerid",
      "end",
      ")",
      "as",
      "backflow_30_user",
      "from",
      "(",
      "select",
      "vplayerid",
      ",",
      "-",
      "-",
      "检查是否满足流失7天回流条件",
      "(",
      "dregdate",
      "<>",
      "dtstatdate",
      ")",
      "and",
      "(",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "1",
      ",",
      "1",
      ")",
      ",",
      "'1'",
      ")",
      ">",
      "0",
      ")",
      "and",
      "(",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "2",
      ",",
      "7",
      ")",
      ",",
      "'1'",
      ")",
      "=",
      "0",
      ")",
      "as",
      "is_backflow_7",
      ",",
      "-",
      "-",
      "检查是否满足流失30天回流条件",
      "(",
      "dregdate",
      "<>",
      "dtstatdate",
      ")",
      "and",
      "(",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "1",
      ",",
      "1",
      ")",
      ",",
      "'1'",
      ")",
      ">",
      "0",
      ")",
      "and",
      "(",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "2",
      ",",
      "30",
      ")",
      ",",
      "'1'",
      ")",
      "=",
      "0",
      ")",
      "as",
      "is_backflow_30",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "'20231201'",
      "and",
      "platid",
      "=",
      "255",
      ")",
      "as",
      "user_flags",
      ";"
    ],
    "query_toks_no_value": [
      "select",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "is_backflow_7",
      "then",
      "vplayerid",
      "end",
      ")",
      "as",
      "backflow_7_user",
      ",",
      "count",
      "(",
      "distinct",
      "case",
      "when",
      "is_backflow_30",
      "then",
      "vplayerid",
      "end",
      ")",
      "as",
      "backflow_30_user",
      "from",
      "(",
      "select",
      "vplayerid",
      ",",
      "-",
      "-",
      "检查是否满足流失7天回流条件",
      "(",
      "dregdate",
      "<>",
      "dtstatdate",
      ")",
      "and",
      "(",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">",
      "value",
      ")",
      "and",
      "(",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "=",
      "value",
      ")",
      "as",
      "is_backflow_7",
      ",",
      "-",
      "-",
      "检查是否满足流失30天回流条件",
      "(",
      "dregdate",
      "<>",
      "dtstatdate",
      ")",
      "and",
      "(",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      ">",
      "value",
      ")",
      "and",
      "(",
      "instr",
      "(",
      "substr",
      "(",
      "cbitmap",
      ",",
      "value",
      ",",
      "value",
      ")",
      ",",
      "value",
      ")",
      "=",
      "value",
      ")",
      "as",
      "is_backflow_30",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "value",
      "and",
      "platid",
      "=",
      "value",
      ")",
      "as",
      "user_flags",
      ";"
    ],
    "question_toks": [
      "统计",
      "2023.12",
      ".",
      "1",
      "流失",
      "7",
      "天",
      "的",
      "回流",
      "用户数",
      "和",
      "流失",
      "30",
      "天",
      "的",
      "回流",
      "用户数",
      "\n",
      "输出",
      "：",
      "流失",
      "7",
      "天",
      "的",
      "回流",
      "用户数",
      "，",
      "流失",
      "30",
      "天",
      "的",
      "回流",
      "用户数"
    ],
    "sql": {
      "select": [
        false,
        [
          [
            "count",
            [
              null,
              "distinct case when is_backflow_7 then vplayerid end"
            ]
          ],
          [
            "count",
            [
              null,
              "distinct case when is_backflow_30 then vplayerid end"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "("
          ]
        ],
        "conds": []
      },
      "where": [
        [
          false,
          "=",
          [
            "none",
            [
              null,
              "dtstatdate"
            ],
            null
          ],
          [
            "string",
            "20231201"
          ],
          null
        ],
        "and",
        [
          false,
          "=",
          [
            "none",
            [
              null,
              "platid"
            ],
            null
          ],
          [
            "column",
            [
              null,
              "255 )"
            ]
          ],
          null
        ]
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": null,
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  },
  {
    "query": "with play_user as (\n    select distinct\n        p.dtstatdate as ds, --日期\n        p.vplayerid    --玩家id\n    from\n        dws_jordass_matchlog_stat_di p\n    join\n        dim_jordass_submodeonline_nf c\n    on\n        p.imode = c.matchsubmodegroup\n    where\n        p.dtstatdate between '20241001' and '20241008'\n        and datediff('20241001', c.onlinedate) >= 7\n        and datediff('20241007', c.onlinedate) <= 90\n)\nselect\n    '20241001-20241007' as period, --周期\n    a.ds,\n    count(distinct a.vplayerid) as play_user_num, --参与人数\n    count(distinct b.vplayerid) as retention_user_num --次留人数\nfrom\n    play_user a\nleft join\n    play_user b\non\n    a.vplayerid = b.vplayerid\n    and b.ds = date_add(a.ds, 1)  -- 次日留存条件\nwhere\n    a.ds between '20241001' and '20241007'\ngroup by\n    a.ds\norder by\n    a.ds;",
    "question": "2024年10月1-2024年10月7 用周期开始时间判断玩法上线时间在7天及以上，周期结束时间判断玩法上线时间在90天及以内的玩法，统计周期内这些玩法的参与和留存情况\n输出：周期(20241001-20241007)，日期(20241001、...、20241007)，参与人数，次留人数",
    "query_toks": [
      "with",
      "play_user",
      "as",
      "(",
      "select",
      "distinct",
      "p",
      ".dtstatdate",
      "as",
      "ds",
      ",",
      "-",
      "-",
      "日期",
      "p",
      ".vplayerid",
      "-",
      "-",
      "玩家id",
      "from",
      "dws_jordass_matchlog_stat_di",
      "p",
      "join",
      "dim_jordass_submodeonline_nf",
      "c",
      "on",
      "p",
      ".imode",
      "=",
      "c",
      ".matchsubmodegroup",
      "where",
      "p",
      ".dtstatdate",
      "between",
      "'20241001'",
      "and",
      "'20241008'",
      "and",
      "datediff",
      "(",
      "'20241001'",
      ",",
      "c",
      ".onlinedate",
      ")",
      ">=",
      "7",
      "and",
      "datediff",
      "(",
      "'20241007'",
      ",",
      "c",
      ".onlinedate",
      ")",
      "<=",
      "90",
      ")",
      "select",
      "'20241001-20241007'",
      "as",
      "period",
      ",",
      "-",
      "-",
      "周期",
      "a",
      ".ds",
      ",",
      "count",
      "(",
      "distinct",
      "a",
      ".vplayerid",
      ")",
      "as",
      "play_user_num",
      ",",
      "-",
      "-",
      "参与人数",
      "count",
      "(",
      "distinct",
      "b",
      ".vplayerid",
      ")",
      "as",
      "retention_user_num",
      "-",
      "-",
      "次留人数",
      "from",
      "play_user",
      "a",
      "left",
      "join",
      "play_user",
      "b",
      "on",
      "a",
      ".vplayerid",
      "=",
      "b",
      ".vplayerid",
      "and",
      "b",
      ".ds",
      "=",
      "date_add",
      "(",
      "a",
      ".ds",
      ",",
      "1",
      ")",
      "-",
      "-",
      "次日留存条件",
      "where",
      "a",
      ".ds",
      "between",
      "'20241001'",
      "and",
      "'20241007'",
      "group",
      "by",
      "a",
      ".ds",
      "order",
      "by",
      "a",
      ".ds",
      ";"
    ],
    "query_toks_no_value": [
      "with",
      "play_user",
      "as",
      "(",
      "select",
      "distinct",
      "p",
      ".dtstatdate",
      "as",
      "ds",
      ",",
      "-",
      "-",
      "日期",
      "p",
      ".vplayerid",
      "-",
      "-",
      "玩家id",
      "from",
      "dws_jordass_matchlog_stat_di",
      "p",
      "join",
      "dim_jordass_submodeonline_nf",
      "c",
      "on",
      "p",
      ".imode",
      "=",
      "c",
      ".matchsubmodegroup",
      "where",
      "p",
      ".dtstatdate",
      "between",
      "value",
      "and",
      "value",
      "and",
      "datediff",
      "(",
      "value",
      ",",
      "c",
      ".onlinedate",
      ")",
      ">=",
      "value",
      "and",
      "datediff",
      "(",
      "value",
      ",",
      "c",
      ".onlinedate",
      ")",
      "<=",
      "value",
      ")",
      "select",
      "value",
      "as",
      "period",
      ",",
      "-",
      "-",
      "周期",
      "a",
      ".ds",
      ",",
      "count",
      "(",
      "distinct",
      "a",
      ".vplayerid",
      ")",
      "as",
      "play_user_num",
      ",",
      "-",
      "-",
      "参与人数",
      "count",
      "(",
      "distinct",
      "b",
      ".vplayerid",
      ")",
      "as",
      "retention_user_num",
      "-",
      "-",
      "次留人数",
      "from",
      "play_user",
      "a",
      "left",
      "join",
      "play_user",
      "b",
      "on",
      "a",
      ".vplayerid",
      "=",
      "b",
      ".vplayerid",
      "and",
      "b",
      ".ds",
      "=",
      "date_add",
      "(",
      "a",
      ".ds",
      ",",
      "value",
      ")",
      "-",
      "-",
      "次日留存条件",
      "where",
      "a",
      ".ds",
      "between",
      "value",
      "and",
      "value",
      "group",
      "by",
      "a",
      ".ds",
      "order",
      "by",
      "a",
      ".ds",
      ";"
    ],
    "question_toks": [
      "2024",
      "年",
      "10",
      "月",
      "1",
      "-",
      "2024",
      "年",
      "10",
      "月",
      "7",
      " ",
      "用",
      "周期",
      "开始",
      "时间",
      "判断",
      "玩法",
      "上线",
      "时间",
      "在",
      "7",
      "天及",
      "以上",
      "，",
      "周期",
      "结束",
      "时间",
      "判断",
      "玩法",
      "上线",
      "时间",
      "在",
      "90",
      "天及",
      "以内",
      "的",
      "玩法",
      "，",
      "统计",
      "周期",
      "内",
      "这些",
      "玩法",
      "的",
      "参与",
      "和",
      "留存",
      "情况",
      "\n",
      "输出",
      "：",
      "周期",
      "(",
      "20241001",
      "-",
      "20241007",
      ")",
      "，",
      "日期",
      "(",
      "20241001",
      "、",
      "...",
      "、",
      "20241007",
      ")",
      "，",
      "参与",
      "人数",
      "，",
      "次留",
      "人数"
    ],
    "sql": {
      "select": [
        true,
        [
          [
            "none",
            [
              "p",
              "dtstatdate"
            ]
          ],
          [
            "none",
            [
              "p",
              "vplayerid"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "dws_jordass_matchlog_stat_di"
          ],
          [
            "table_unit",
            "dim_jordass_submodeonline_nf"
          ]
        ],
        "conds": [
          [
            false,
            "=",
            [
              "none",
              [
                "p",
                "imode"
              ],
              null
            ],
            [
              "column",
              [
                "c",
                "matchsubmodegroup"
              ]
            ],
            null
          ]
        ]
      },
      "where": [
        [
          false,
          "between",
          [
            "none",
            [
              "p",
              "dtstatdate"
            ],
            null
          ],
          [
            "string",
            "20241001"
          ],
          null
        ],
        "and",
        "'20241008'",
        "and",
        [
          false,
          ">=",
          [
            "none",
            [
              "datediff",
              "'20241001', c.onlinedate"
            ],
            null
          ],
          [
            "number",
            7.0
          ],
          null
        ],
        "and",
        [
          false,
          "<=",
          [
            "none",
            [
              "datediff",
              "'20241007', c.onlinedate"
            ],
            null
          ],
          [
            "column",
            [
              null,
              "90 )"
            ]
          ],
          null
        ]
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": null,
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  },
  {
    "query": "select\n    register_date,\n    count(distinct vplayerid) as new_user_cnt,\n    round(sum(case when datediff_pay < 1 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv1,\n    round(sum(case when datediff_pay < 3 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv3,\n    round(sum(case when datediff_pay < 7 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv7,\n    round(sum(case when datediff_pay < 14 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv14,\n    round(sum(case when datediff_pay < 30 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv30,\n    round(sum(case when datediff_pay < 60 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv60,\n    round(sum(case when datediff_pay < 90 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv90,\n    round(sum(case when datediff_pay < 180 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2) as ltv180\nfrom (\n    select\n        s1.register_date,\n        s1.vplayerid,\n        s2.pay_date,\n        datediff(s2.pay_date, s1.register_date) as datediff_pay,\n        sum(s2.pay_amount) as sum_pay_amount\n    from (\n        select\n            distinct dregdate as register_date,\n            vplayerid\n        from dws_jordass_login_df\n        where dtstatdate = '20240131'\n          and platid = 255\n          and dregdate >= '20240101' and dregdate <= '20240131'\n    ) s1\n    left join (\n        select\n            dtstatdate as pay_date,\n            vplayerid,\n            sum(imoney/100) as pay_amount\n        from dws_jordass_water_di\n        where dtstatdate >= '20240101' and dtstatdate <= date_add('20240131', 179)\n          and platid = 255\n        group by dtstatdate, vplayerid\n    ) s2 on s1.vplayerid = s2.vplayerid\n    group by s1.register_date, s1.vplayerid, s2.pay_date\n) base\ngroup by register_date",
    "question": "时间：2024.01.01-2024.01.31\n每日新增用户的LTV，LTV1~LTV10\n输出：注册日期(20240101、20240102、...、20240131)、新进用户数、LTV1、LTV3、LTV7、LTV14、LTV30、LTV60、LTV90、LTV180\n",
    "query_toks": [
      "select",
      "register_date",
      ",",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      "as",
      "new_user_cnt",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "1",
      "then",
      "sum_pay_amount",
      "else",
      "0",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "2",
      ")",
      "as",
      "ltv1",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "3",
      "then",
      "sum_pay_amount",
      "else",
      "0",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "2",
      ")",
      "as",
      "ltv3",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "7",
      "then",
      "sum_pay_amount",
      "else",
      "0",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "2",
      ")",
      "as",
      "ltv7",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "14",
      "then",
      "sum_pay_amount",
      "else",
      "0",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "2",
      ")",
      "as",
      "ltv14",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "30",
      "then",
      "sum_pay_amount",
      "else",
      "0",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "2",
      ")",
      "as",
      "ltv30",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "60",
      "then",
      "sum_pay_amount",
      "else",
      "0",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "2",
      ")",
      "as",
      "ltv60",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "90",
      "then",
      "sum_pay_amount",
      "else",
      "0",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "2",
      ")",
      "as",
      "ltv90",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "180",
      "then",
      "sum_pay_amount",
      "else",
      "0",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "2",
      ")",
      "as",
      "ltv180",
      "from",
      "(",
      "select",
      "s1",
      ".register_date",
      ",",
      "s1",
      ".vplayerid",
      ",",
      "s2",
      ".pay_date",
      ",",
      "datediff",
      "(",
      "s2",
      ".pay_date",
      ",",
      "s1",
      ".register_date",
      ")",
      "as",
      "datediff_pay",
      ",",
      "sum",
      "(",
      "s2",
      ".pay_amount",
      ")",
      "as",
      "sum_pay_amount",
      "from",
      "(",
      "select",
      "distinct",
      "dregdate",
      "as",
      "register_date",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "'20240131'",
      "and",
      "platid",
      "=",
      "255",
      "and",
      "dregdate",
      ">=",
      "'20240101'",
      "and",
      "dregdate",
      "<=",
      "'20240131'",
      ")",
      "s1",
      "left",
      "join",
      "(",
      "select",
      "dtstatdate",
      "as",
      "pay_date",
      ",",
      "vplayerid",
      ",",
      "sum",
      "(",
      "imoney",
      "/",
      "100",
      ")",
      "as",
      "pay_amount",
      "from",
      "dws_jordass_water_di",
      "where",
      "dtstatdate",
      ">=",
      "'20240101'",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "'20240131'",
      ",",
      "179",
      ")",
      "and",
      "platid",
      "=",
      "255",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      ")",
      "s2",
      "on",
      "s1",
      ".vplayerid",
      "=",
      "s2",
      ".vplayerid",
      "group",
      "by",
      "s1",
      ".register_date",
      ",",
      "s1",
      ".vplayerid",
      ",",
      "s2",
      ".pay_date",
      ")",
      "base",
      "group",
      "by",
      "register_date"
    ],
    "query_toks_no_value": [
      "select",
      "register_date",
      ",",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      "as",
      "new_user_cnt",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "value",
      "then",
      "sum_pay_amount",
      "else",
      "value",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "value",
      ")",
      "as",
      "ltv1",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "value",
      "then",
      "sum_pay_amount",
      "else",
      "value",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "value",
      ")",
      "as",
      "ltv3",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "value",
      "then",
      "sum_pay_amount",
      "else",
      "value",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "value",
      ")",
      "as",
      "ltv7",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "value",
      "then",
      "sum_pay_amount",
      "else",
      "value",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "value",
      ")",
      "as",
      "ltv14",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "value",
      "then",
      "sum_pay_amount",
      "else",
      "value",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "value",
      ")",
      "as",
      "ltv30",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "value",
      "then",
      "sum_pay_amount",
      "else",
      "value",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "value",
      ")",
      "as",
      "ltv60",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "value",
      "then",
      "sum_pay_amount",
      "else",
      "value",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "value",
      ")",
      "as",
      "ltv90",
      ",",
      "round",
      "(",
      "sum",
      "(",
      "case",
      "when",
      "datediff_pay",
      "<",
      "value",
      "then",
      "sum_pay_amount",
      "else",
      "value",
      "end",
      ")",
      "/",
      "count",
      "(",
      "distinct",
      "vplayerid",
      ")",
      ",",
      "value",
      ")",
      "as",
      "ltv180",
      "from",
      "(",
      "select",
      "s1",
      ".register_date",
      ",",
      "s1",
      ".vplayerid",
      ",",
      "s2",
      ".pay_date",
      ",",
      "datediff",
      "(",
      "s2",
      ".pay_date",
      ",",
      "s1",
      ".register_date",
      ")",
      "as",
      "datediff_pay",
      ",",
      "sum",
      "(",
      "s2",
      ".pay_amount",
      ")",
      "as",
      "sum_pay_amount",
      "from",
      "(",
      "select",
      "distinct",
      "dregdate",
      "as",
      "register_date",
      ",",
      "vplayerid",
      "from",
      "dws_jordass_login_df",
      "where",
      "dtstatdate",
      "=",
      "value",
      "and",
      "platid",
      "=",
      "value",
      "and",
      "dregdate",
      ">=",
      "value",
      "and",
      "dregdate",
      "<=",
      "value",
      ")",
      "s1",
      "left",
      "join",
      "(",
      "select",
      "dtstatdate",
      "as",
      "pay_date",
      ",",
      "vplayerid",
      ",",
      "sum",
      "(",
      "imoney",
      "/",
      "value",
      ")",
      "as",
      "pay_amount",
      "from",
      "dws_jordass_water_di",
      "where",
      "dtstatdate",
      ">=",
      "value",
      "and",
      "dtstatdate",
      "<=",
      "date_add",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "platid",
      "=",
      "value",
      "group",
      "by",
      "dtstatdate",
      ",",
      "vplayerid",
      ")",
      "s2",
      "on",
      "s1",
      ".vplayerid",
      "=",
      "s2",
      ".vplayerid",
      "group",
      "by",
      "s1",
      ".register_date",
      ",",
      "s1",
      ".vplayerid",
      ",",
      "s2",
      ".pay_date",
      ")",
      "base",
      "group",
      "by",
      "register_date"
    ],
    "question_toks": [
      "时间",
      "：",
      "2024.01",
      ".",
      "01",
      "-",
      "2024.01",
      ".",
      "31",
      "\n",
      "每日",
      "新增",
      "用户",
      "的",
      "LTV",
      "，",
      "LTV1",
      "~",
      "LTV10",
      "\n",
      "输出",
      "：",
      "注册",
      "日期",
      "(",
      "20240101",
      "、",
      "20240102",
      "、",
      "...",
      "、",
      "20240131",
      ")",
      "、",
      "新进",
      "用户数",
      "、",
      "LTV1",
      "、",
      "LTV3",
      "、",
      "LTV7",
      "、",
      "LTV14",
      "、",
      "LTV30",
      "、",
      "LTV60",
      "、",
      "LTV90",
      "、",
      "LTV180",
      "\n"
    ],
    "sql": {
      "select": [
        false,
        [
          [
            "none",
            [
              null,
              "register_date"
            ]
          ],
          [
            "count",
            [
              null,
              "distinct vplayerid"
            ]
          ],
          [
            "none",
            [
              "round",
              "sum(case when datediff_pay < 1 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2"
            ]
          ],
          [
            "none",
            [
              "round",
              "sum(case when datediff_pay < 3 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2"
            ]
          ],
          [
            "none",
            [
              "round",
              "sum(case when datediff_pay < 7 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2"
            ]
          ],
          [
            "none",
            [
              "round",
              "sum(case when datediff_pay < 14 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2"
            ]
          ],
          [
            "none",
            [
              "round",
              "sum(case when datediff_pay < 30 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2"
            ]
          ],
          [
            "none",
            [
              "round",
              "sum(case when datediff_pay < 60 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2"
            ]
          ],
          [
            "none",
            [
              "round",
              "sum(case when datediff_pay < 90 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2"
            ]
          ],
          [
            "none",
            [
              "round",
              "sum(case when datediff_pay < 180 then sum_pay_amount else 0 end) / count(distinct vplayerid), 2"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "("
          ]
        ],
        "conds": []
      },
      "where": [
        [
          false,
          "=",
          [
            "none",
            [
              null,
              "dtstatdate"
            ],
            null
          ],
          [
            "string",
            "20240131"
          ],
          null
        ],
        "and",
        [
          false,
          "=",
          [
            "none",
            [
              null,
              "platid"
            ],
            null
          ],
          [
            "number",
            255.0
          ],
          null
        ],
        "and",
        [
          false,
          ">=",
          [
            "none",
            [
              null,
              "dregdate"
            ],
            null
          ],
          [
            "string",
            "20240101"
          ],
          null
        ],
        "and",
        [
          false,
          "<=",
          [
            "none",
            [
              null,
              "dregdate"
            ],
            null
          ],
          [
            "column",
            [
              null,
              "'20240131' ) s1 left join ("
            ]
          ],
          null
        ]
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": null,
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  },
  {
    "query": "-- 查询限定抽取阶梯活动相关数据\nselect\n    dtstatdate,\n    pv,\n    uv\nfrom (\n    -- 按天统计\n    select\n        substr(tdbank_imp_date, 1, 8) as dtstatdate,\n        count(*)                       as pv,\n        count(distinct uid)            as uv\n    from dwd_jordass_activitypress_hi\n    where tdbank_imp_date between '2024112900' and '2024121923'\n      and ireason   = 2411291018\n      and buttontype = 10045\n      and extarg1   in (117, 115)\n    group by substr(tdbank_imp_date, 1, 8)\n\n    union all\n\n    -- 汇总\n    select\n        '汇总' as dtstatdate,\n        count(*)            as pv,\n        count(distinct uid) as uv\n    from dwd_jordass_activitypress_hi\n    where tdbank_imp_date between '2024112900' and '2024121923'\n      and ireason   = 2411291018\n      and buttontype = 10045\n      and extarg1   in (117, 115)\n) f \n;\n",
    "question": "统计限定抽取阶梯活动每天的pv和角色数\n活动日期\t2024.11.29-12.19\t\n输出：日期(20241129、...、20241219、汇总)、pv、uv",
    "query_toks": [
      "-",
      "-",
      "查询限定抽取阶梯活动相关数据",
      "select",
      "dtstatdate",
      ",",
      "pv",
      ",",
      "uv",
      "from",
      "(",
      "-",
      "-",
      "按天统计",
      "select",
      "substr",
      "(",
      "tdbank_imp_date",
      ",",
      "1",
      ",",
      "8",
      ")",
      "as",
      "dtstatdate",
      ",",
      "count",
      "(",
      "*",
      ")",
      "as",
      "pv",
      ",",
      "count",
      "(",
      "distinct",
      "uid",
      ")",
      "as",
      "uv",
      "from",
      "dwd_jordass_activitypress_hi",
      "where",
      "tdbank_imp_date",
      "between",
      "'2024112900'",
      "and",
      "'2024121923'",
      "and",
      "ireason",
      "=",
      "2411291018",
      "and",
      "buttontype",
      "=",
      "10045",
      "and",
      "extarg1",
      "in",
      "(",
      "117",
      ",",
      "115",
      ")",
      "group",
      "by",
      "substr",
      "(",
      "tdbank_imp_date",
      ",",
      "1",
      ",",
      "8",
      ")",
      "union",
      "all",
      "-",
      "-",
      "汇总",
      "select",
      "'汇总'",
      "as",
      "dtstatdate",
      ",",
      "count",
      "(",
      "*",
      ")",
      "as",
      "pv",
      ",",
      "count",
      "(",
      "distinct",
      "uid",
      ")",
      "as",
      "uv",
      "from",
      "dwd_jordass_activitypress_hi",
      "where",
      "tdbank_imp_date",
      "between",
      "'2024112900'",
      "and",
      "'2024121923'",
      "and",
      "ireason",
      "=",
      "2411291018",
      "and",
      "buttontype",
      "=",
      "10045",
      "and",
      "extarg1",
      "in",
      "(",
      "117",
      ",",
      "115",
      ")",
      ")",
      "f",
      ";"
    ],
    "query_toks_no_value": [
      "-",
      "-",
      "查询限定抽取阶梯活动相关数据",
      "select",
      "dtstatdate",
      ",",
      "pv",
      ",",
      "uv",
      "from",
      "(",
      "-",
      "-",
      "按天统计",
      "select",
      "substr",
      "(",
      "tdbank_imp_date",
      ",",
      "value",
      ",",
      "value",
      ")",
      "as",
      "dtstatdate",
      ",",
      "count",
      "(",
      "*",
      ")",
      "as",
      "pv",
      ",",
      "count",
      "(",
      "distinct",
      "uid",
      ")",
      "as",
      "uv",
      "from",
      "dwd_jordass_activitypress_hi",
      "where",
      "tdbank_imp_date",
      "between",
      "value",
      "and",
      "value",
      "and",
      "ireason",
      "=",
      "value",
      "and",
      "buttontype",
      "=",
      "value",
      "and",
      "extarg1",
      "in",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "substr",
      "(",
      "tdbank_imp_date",
      ",",
      "value",
      ",",
      "value",
      ")",
      "union",
      "all",
      "-",
      "-",
      "汇总",
      "select",
      "value",
      "as",
      "dtstatdate",
      ",",
      "count",
      "(",
      "*",
      ")",
      "as",
      "pv",
      ",",
      "count",
      "(",
      "distinct",
      "uid",
      ")",
      "as",
      "uv",
      "from",
      "dwd_jordass_activitypress_hi",
      "where",
      "tdbank_imp_date",
      "between",
      "value",
      "and",
      "value",
      "and",
      "ireason",
      "=",
      "value",
      "and",
      "buttontype",
      "=",
      "value",
      "and",
      "extarg1",
      "in",
      "(",
      "value",
      ",",
      "value",
      ")",
      ")",
      "f",
      ";"
    ],
    "question_toks": [
      "统计",
      "限定",
      "抽取",
      "阶梯",
      "活动",
      "每天",
      "的",
      "pv",
      "和",
      "角色",
      "数",
      "\n",
      "活动",
      "日期",
      "\t",
      "2024.11",
      ".",
      "29",
      "-",
      "12.19",
      "\t",
      "\n",
      "输出",
      "：",
      "日期",
      "(",
      "20241129",
      "、",
      "...",
      "、",
      "20241219",
      "、",
      "汇总",
      ")",
      "、",
      "pv",
      "、",
      "uv"
    ],
    "sql": {
      "select": [
        false,
        [
          [
            "none",
            [
              null,
              "dtstatdate"
            ]
          ],
          [
            "none",
            [
              null,
              "pv"
            ]
          ],
          [
            "none",
            [
              null,
              "uv"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "("
          ]
        ],
        "conds": []
      },
      "where": [
        [
          false,
          "between",
          [
            "none",
            [
              null,
              "tdbank_imp_date"
            ],
            null
          ],
          [
            "string",
            "2024112900"
          ],
          null
        ],
        "and",
        "'2024121923'",
        "and",
        [
          false,
          "=",
          [
            "none",
            [
              null,
              "ireason"
            ],
            null
          ],
          [
            "number",
            2411291018.0
          ],
          null
        ],
        "and",
        [
          false,
          "=",
          [
            "none",
            [
              null,
              "buttontype"
            ],
            null
          ],
          [
            "number",
            10045.0
          ],
          null
        ],
        "and",
        [
          false,
          "in",
          [
            "none",
            [
              null,
              "extarg1"
            ],
            null
          ],
          [
            "sql",
            {
              "select": null,
              "from": null,
              "where": null,
              "groupBy": null,
              "orderBy": null,
              "having": null,
              "limit": null,
              "union": null,
              "intersect": null,
              "except": null
            }
          ],
          null
        ]
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": {
        "select": null,
        "from": null,
        "where": null,
        "groupBy": null,
        "orderBy": null,
        "having": null,
        "limit": null,
        "union": null,
        "intersect": null,
        "except": null
      },
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  },
  {
    "query": "select \n    s1.trigger_count as `trigger_count`, -- 第x次触发\n    count(distinct s1.vplayerid) as `trigger_user_cnt`, -- 触发用户数\n    sum(s2.draw_count) as `total_draw_count` -- 用户总抽奖次数\nfrom (\n    select\n        vplayerid,\n        dteventtime,\n        coalesce(lead(dteventtime) over (partition by vplayerid order by dteventtime), '9999-12-31 23:59:59')  as next_dteventtime,\n        row_number() over (partition by vplayerid order by dteventtime) as trigger_count\n    from (\n        select distinct\n            vplayerid,\n            dteventtime\n        from dwd_jordass_activityrecord_hi\n        where tdbank_imp_date >= '2025011100'\n        and tdbank_imp_date <= '2025012423'\n        and actid = 2411070621\n        and acttype = 10062\n        and recodtype in ('1', '2')\n        and strarg1 <> '0'\n    ) ff1\n) s1 \njoin (\n    select\n        vplayerid,\n        dteventtime,\n        sum(arg1) as draw_count\n    from dwd_jordass_activityrecord_hi  -- actgeneralflow表\n    where tdbank_imp_date >= \"2025011100\" and tdbank_imp_date <= \"2025012423\" -- 时间区间：20250111-20250124\n    and actid = 2411070621\n    and acttype = 10062\n    and recodtype in (\"1\", \"2\")\n    group by vplayerid, dteventtime\n\n    \n) s2 \non s1.vplayerid = s2.vplayerid and s2. dteventtime >= s1.dteventtime and s2.dteventtime < s1.next_dteventtime\ngroup by s1.trigger_count\n\n",
    "question": "统计：20250111-20250124时间区间内，幻境使者活动抽奖用户第X次触发赠送后，这些用户的总抽奖次数\n输出：第X次触发,触发用户数,用户总抽奖次数",
    "query_toks": [
      "select",
      "s1",
      ".trigger_count",
      "as",
      "`",
      "trigger_count",
      "`",
      ",",
      "-",
      "-",
      "第x次触发",
      "count",
      "(",
      "distinct",
      "s1",
      ".vplayerid",
      ")",
      "as",
      "`",
      "trigger_user_cnt",
      "`",
      ",",
      "-",
      "-",
      "触发用户数",
      "sum",
      "(",
      "s2",
      ".draw_count",
      ")",
      "as",
      "`",
      "total_draw_count",
      "`",
      "-",
      "-",
      "用户总抽奖次数",
      "from",
      "(",
      "select",
      "vplayerid",
      ",",
      "dteventtime",
      ",",
      "coalesce",
      "(",
      "lead",
      "(",
      "dteventtime",
      ")",
      "over",
      "(",
      "partition",
      "by",
      "vplayerid",
      "order",
      "by",
      "dteventtime",
      ")",
      ",",
      "'9999-12-31 23:59:59'",
      ")",
      "as",
      "next_dteventtime",
      ",",
      "row_number",
      "(",
      ")",
      "over",
      "(",
      "partition",
      "by",
      "vplayerid",
      "order",
      "by",
      "dteventtime",
      ")",
      "as",
      "trigger_count",
      "from",
      "(",
      "select",
      "distinct",
      "vplayerid",
      ",",
      "dteventtime",
      "from",
      "dwd_jordass_activityrecord_hi",
      "where",
      "tdbank_imp_date",
      ">=",
      "'2025011100'",
      "and",
      "tdbank_imp_date",
      "<=",
      "'2025012423'",
      "and",
      "actid",
      "=",
      "2411070621",
      "and",
      "acttype",
      "=",
      "10062",
      "and",
      "recodtype",
      "in",
      "(",
      "'1'",
      ",",
      "'2'",
      ")",
      "and",
      "strarg1",
      "<>",
      "'0'",
      ")",
      "ff1",
      ")",
      "s1",
      "join",
      "(",
      "select",
      "vplayerid",
      ",",
      "dteventtime",
      ",",
      "sum",
      "(",
      "arg1",
      ")",
      "as",
      "draw_count",
      "from",
      "dwd_jordass_activityrecord_hi",
      "-",
      "-",
      "actgeneralflow表",
      "where",
      "tdbank_imp_date",
      ">=",
      "\"2025011100\"",
      "and",
      "tdbank_imp_date",
      "<=",
      "\"2025012423\"",
      "-",
      "-",
      "时间区间",
      "：",
      "20250111",
      "-",
      "20250124",
      "and",
      "actid",
      "=",
      "2411070621",
      "and",
      "acttype",
      "=",
      "10062",
      "and",
      "recodtype",
      "in",
      "(",
      "\"1\"",
      ",",
      "\"2\"",
      ")",
      "group",
      "by",
      "vplayerid",
      ",",
      "dteventtime",
      ")",
      "s2",
      "on",
      "s1",
      ".vplayerid",
      "=",
      "s2",
      ".vplayerid",
      "and",
      "s2",
      ".",
      "dteventtime",
      ">=",
      "s1",
      ".dteventtime",
      "and",
      "s2",
      ".dteventtime",
      "<",
      "s1",
      ".next_dteventtime",
      "group",
      "by",
      "s1",
      ".trigger_count"
    ],
    "query_toks_no_value": [
      "select",
      "s1",
      ".trigger_count",
      "as",
      "`",
      "trigger_count",
      "`",
      ",",
      "-",
      "-",
      "第x次触发",
      "count",
      "(",
      "distinct",
      "s1",
      ".vplayerid",
      ")",
      "as",
      "`",
      "trigger_user_cnt",
      "`",
      ",",
      "-",
      "-",
      "触发用户数",
      "sum",
      "(",
      "s2",
      ".draw_count",
      ")",
      "as",
      "`",
      "total_draw_count",
      "`",
      "-",
      "-",
      "用户总抽奖次数",
      "from",
      "(",
      "select",
      "vplayerid",
      ",",
      "dteventtime",
      ",",
      "coalesce",
      "(",
      "lead",
      "(",
      "dteventtime",
      ")",
      "over",
      "(",
      "partition",
      "by",
      "vplayerid",
      "order",
      "by",
      "dteventtime",
      ")",
      ",",
      "value",
      ")",
      "as",
      "next_dteventtime",
      ",",
      "row_number",
      "(",
      ")",
      "over",
      "(",
      "partition",
      "by",
      "vplayerid",
      "order",
      "by",
      "dteventtime",
      ")",
      "as",
      "trigger_count",
      "from",
      "(",
      "select",
      "distinct",
      "vplayerid",
      ",",
      "dteventtime",
      "from",
      "dwd_jordass_activityrecord_hi",
      "where",
      "tdbank_imp_date",
      ">=",
      "value",
      "and",
      "tdbank_imp_date",
      "<=",
      "value",
      "and",
      "actid",
      "=",
      "value",
      "and",
      "acttype",
      "=",
      "value",
      "and",
      "recodtype",
      "in",
      "(",
      "value",
      ",",
      "value",
      ")",
      "and",
      "strarg1",
      "<>",
      "value",
      ")",
      "ff1",
      ")",
      "s1",
      "join",
      "(",
      "select",
      "vplayerid",
      ",",
      "dteventtime",
      ",",
      "sum",
      "(",
      "arg1",
      ")",
      "as",
      "draw_count",
      "from",
      "dwd_jordass_activityrecord_hi",
      "-",
      "-",
      "actgeneralflow表",
      "where",
      "tdbank_imp_date",
      ">=",
      "value",
      "and",
      "tdbank_imp_date",
      "<=",
      "value",
      "-",
      "-",
      "时间区间",
      "：",
      "value",
      "-",
      "value",
      "and",
      "actid",
      "=",
      "value",
      "and",
      "acttype",
      "=",
      "value",
      "and",
      "recodtype",
      "in",
      "(",
      "value",
      ",",
      "value",
      ")",
      "group",
      "by",
      "vplayerid",
      ",",
      "dteventtime",
      ")",
      "s2",
      "on",
      "s1",
      ".vplayerid",
      "=",
      "s2",
      ".vplayerid",
      "and",
      "s2",
      ".",
      "dteventtime",
      ">=",
      "s1",
      ".dteventtime",
      "and",
      "s2",
      ".dteventtime",
      "<",
      "s1",
      ".next_dteventtime",
      "group",
      "by",
      "s1",
      ".trigger_count"
    ],
    "question_toks": [
      "统计",
      "：",
      "20250111",
      "-",
      "20250124",
      "时间",
      "区间",
      "内",
      "，",
      "幻境",
      "使者",
      "活动",
      "抽奖",
      "用户",
      "第",
      "X",
      "次",
      "触发",
      "赠送",
      "后",
      "，",
      "这些",
      "用户",
      "的",
      "总",
      "抽奖",
      "次数",
      "\n",
      "输出",
      "：",
      "第",
      "X",
      "次",
      "触发",
      ",",
      "触发",
      "用户数",
      ",",
      "用户",
      "总",
      "抽奖",
      "次数"
    ],
    "sql": {
      "select": [
        false,
        [
          [
            "none",
            [
              "s1",
              "trigger_count"
            ]
          ],
          [
            "count",
            [
              "distinct s1",
              "vplayerid"
            ]
          ],
          [
            "sum",
            [
              "s2",
              "draw_count"
            ]
          ]
        ]
      ],
      "from": {
        "table_units": [
          [
            "table_unit",
            "("
          ]
        ],
        "conds": []
      },
      "where": [
        [
          false,
          ">=",
          [
            "none",
            [
              null,
              "tdbank_imp_date"
            ],
            null
          ],
          [
            "string",
            "2025011100"
          ],
          null
        ],
        "and",
        [
          false,
          "<=",
          [
            "none",
            [
              null,
              "tdbank_imp_date"
            ],
            null
          ],
          [
            "string",
            "2025012423"
          ],
          null
        ],
        "and",
        [
          false,
          "=",
          [
            "none",
            [
              null,
              "actid"
            ],
            null
          ],
          [
            "number",
            2411070621.0
          ],
          null
        ],
        "and",
        [
          false,
          "=",
          [
            "none",
            [
              null,
              "acttype"
            ],
            null
          ],
          [
            "number",
            10062.0
          ],
          null
        ],
        "and",
        [
          false,
          "in",
          [
            "none",
            [
              null,
              "recodtype"
            ],
            null
          ],
          [
            "sql",
            {
              "select": null,
              "from": null,
              "where": null,
              "groupBy": null,
              "orderBy": null,
              "having": null,
              "limit": null,
              "union": null,
              "intersect": null,
              "except": null
            }
          ],
          null
        ],
        "and",
        "strarg1 <> '0' ) ff1 ) s1 join ("
      ],
      "groupBy": null,
      "orderBy": null,
      "having": null,
      "limit": null,
      "union": null,
      "intersect": null,
      "except": null
    },
    "db_id": "text2sql"
  }
]